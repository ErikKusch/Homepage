<!DOCTYPE html><html lang="en-gb" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Erik Kusch">

  
  
  
    
  
  <meta name="description" content="This is a quick documentation of a mock research project used throughout all `R` exercises during this seminar series.">

  
  <link rel="alternate" hreflang="en-gb" href="https://www.erikkusch.com/courses/excursions-into-biostatistics/research-project/">

  


  
  
  
  <meta name="theme-color" content="#858383">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186216138-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186216138-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.erikkusch.com/courses/excursions-into-biostatistics/research-project/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ErikKusch">
  <meta property="twitter:creator" content="@ErikKusch">
  
  <meta property="og:site_name" content="Erik Kusch">
  <meta property="og:url" content="https://www.erikkusch.com/courses/excursions-into-biostatistics/research-project/">
  <meta property="og:title" content="Research Project | Erik Kusch">
  <meta property="og:description" content="This is a quick documentation of a mock research project used throughout all `R` exercises during this seminar series."><meta property="og:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg">
  <meta property="twitter:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg"><meta property="og:locale" content="en-gb">
  
    
      <meta property="article:published_time" content="2021-02-27T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-02-27T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Research Project | Erik Kusch</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses & Workshops</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/krigr/"><span>KrigR - State-of-the-Art Climate Data within R</span></a>
            
              <a class="dropdown-item" href="/courses/gbif/"><span>Accessing and Referencing GBIF Data for Research</span></a>
            
              <a class="dropdown-item" href="/courses/rethinking/"><span>Statistical Rethinking - Introduction to Bayesian Statistics</span></a>
            
              <a class="dropdown-item" href="/courses/bayes-nets/"><span>Bayesian Networks - Causality through Bayesian Approaches</span></a>
            
              <a class="dropdown-item" href="/courses/biostat101/"><span>Biostats 101 - An Introduction to Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/excursions-into-biostatistics/"><span>Biostats 301 - Excursions into Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/bftp-biome-detection/"><span>BFTP - First Steps in Macroecology in R</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/media/CV_ErikKusch.html" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/excursions-into-biostatistics/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/excursions-into-biostatistics/1_biostatistics-wait.-what/">Seminars</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/excursions-into-biostatistics/1_biostatistics-wait.-what/">Biostatistics - Wait... What?!</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/2_statistical-terminology-the-basics-misconceptions-and-pedantics/">Statistical Terminology</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/3_coding-practices-life-with-r/">Coding Practices - Life with R</a>
      </li>
      
      <li class="active">
        <a href="/courses/excursions-into-biostatistics/research-project/">Research Project for our Exercises</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/">Data Handling and Data Assumptions</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/classifications-order-from-chaos/">Classifications - Order from Chaos</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/regressions-correlations-for-the-advanced/">Regressions - Correlations for the Advanced</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/excursion-into-biostatistics/">Model Selection and Statistical Significance</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/8_statistical-significance-in-biology-conventions-abstractions-and-the-future/">Statistical Significance in Biology</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/9_rmarkdown-manuscript-workflow-revisited/">RMarkdown - Manuscript Workflow Revisited</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/10_troubleshooting_r-isolating-issues-and-asking-questions/">Troubleshooting R - Isolating Issues and Asking Questions</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#our-resarch-project">Our Resarch Project</a>
      <ul>
        <li><a href="#the-data">The Data</a></li>
        <li><a href="#adding-information">Adding Information</a></li>
        <li><a href="#hypotheses">Hypotheses</a></li>
      </ul>
    </li>
    <li><a href="#sessioninfo">SessionInfo</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Research Project</h1>

          <div class="article-style">
            <h2 id="our-resarch-project">Our Resarch Project</h2>
<p>Here (and over the next few exercises in this &ldquo;course&rdquo;), we are looking at a big (and entirely fictional) data base of the common house sparrow (<em>Passer domesticus</em>). In particular, we are interested in the <strong>Evolution of <em>Passer domesticus</em> in Response to Climate Change</strong>.</p>
<h3 id="the-data">The Data</h3>
<p>I have created a large data set for this exercise which is available in a cleaned and properly handled version <a href="https://github.com/ErikKusch/Homepage/raw/master/content/courses/excursions-into-biostatistics/Data.rar" target="_blank"> here</a>.</p>
<h4 id="reading-the-data-into-r">Reading the Data into <code>R</code></h4>
<p>Let&rsquo;s start by reading the data into <code>R</code> and taking an initial look at it:</p>
<pre><code class="language-r">Sparrows_df &lt;- readRDS(file.path(&quot;Data&quot;, &quot;SparrowData.rds&quot;))
Sparrows_df &lt;- Sparrows_df[!is.na(Sparrows_df$Weight), ]
head(Sparrows_df)
</code></pre>
<pre><code>##   Index Latitude Longitude     Climate Population.Status Weight Height Wing.Chord Colour    Sex Nesting.Site Nesting.Height Number.of.Eggs Egg.Weight Flock Home.Range Predator.Presence Predator.Type
## 1    SI       60       100 Continental            Native  34.05  12.87       6.67  Brown   Male         &lt;NA&gt;             NA             NA         NA     B      Large               Yes         Avian
## 2    SI       60       100 Continental            Native  34.86  13.68       6.79   Grey   Male         &lt;NA&gt;             NA             NA         NA     B      Large               Yes         Avian
## 3    SI       60       100 Continental            Native  32.34  12.66       6.64  Black Female        Shrub          35.60              1       3.21     C      Large               Yes         Avian
## 4    SI       60       100 Continental            Native  34.78  15.09       7.00  Brown Female        Shrub          47.75              0         NA     E      Large               Yes         Avian
## 5    SI       60       100 Continental            Native  35.01  13.82       6.81   Grey   Male         &lt;NA&gt;             NA             NA         NA     B      Large               Yes         Avian
## 6    SI       60       100 Continental            Native  32.36  12.67       6.64  Brown Female        Shrub          32.47              1       3.17     E      Large               Yes         Avian
</code></pre>
<h4 id="variables">Variables</h4>
<p>When building models or trying to explain anything about our data set, we need to consider all the different variables and the information contained therein. In this data set, we have access to:</p>
<ol>
<li><code>Index</code> [<em>Factor</em>] - an abbreviation of <code>Site</code> records</li>
<li><code>Latitude</code> [<em>Numeric</em>] - an identifier of where specific sparrow measurements where taken</li>
<li><code>Longitude</code> [<em>Numeric</em>] - an identifier of where specific sparrow measurements where taken</li>
<li><code>Climate</code> [<em>Factor</em>] - local climate types that sparrows are subjected to (e.g. coastal, continental, and semi-coastal)</li>
<li><code>Population.Status</code> [<em>Factor</em>] - population status (e.g. native or introduced)</li>
<li><code>Weight</code> [<em>Numeric</em>] - sparrow weight [g]; Range: 13-40g</li>
<li><code>Height</code> [<em>Numeric</em>] - sparrow height/length [cm]; Range: 10-22cm</li>
<li><code>Wing.Chord</code> [<em>Numeric</em>] - wing length [cm]; Range: 6-10cm</li>
<li><code>Colour</code> [<em>Factor</em>] - main plumage colour (e.g. brown, grey, and black)</li>
<li><code>Sex</code> [<em>Factor</em>] - sparrow sex</li>
<li><code>Nesting.Site</code> [<em>Factor</em>] - nesting conditions, only recorded for females (e.g. tree or shrub)</li>
<li><code>Nesting.Height</code> [<em>Numeric</em>] - nest elevation above ground level, only recorded for females</li>
<li><code>Number.of.Eggs</code> [<em>Numeric</em>] - number of eggs per nest, only recorded for females</li>
<li><code>Egg.Weight</code> [<em>Numeric</em>] - mean weight of eggs per nest, only recorded for females</li>
<li><code>Flock</code> [<em>Factor</em>] - which flock at each location each sparrow belongs to</li>
<li><code>Home.Range</code> [<em>Factor</em>] - size of home range of each flock (e.g. Small, Medium, and Large)</li>
<li><code>Predator.Presence</code> [<em>Factor</em>] - if a predator is present at a station (e.g. No or Yes)</li>
<li><code>Predator.Type</code> [<em>Factor</em>] - what kind of predator is present (e.g. Avian, Non-Avian, or None)</li>
</ol>
<p>Note that the variables <code>Longitude</code> and <code>Latitude</code> may be used to retrieve climate data variables from a host of data sources.</p>
<h4 id="locations">Locations</h4>
<p>Looking at our data, we notice that it comes at distinct stations. Let&rsquo;s visualise where they are:</p>
<pre><code class="language-r">library(&quot;leaflet&quot;)
Plot_df &lt;- Sparrows_df[, c(&quot;Longitude&quot;, &quot;Latitude&quot;, &quot;Index&quot;, &quot;Climate&quot;, &quot;Population.Status&quot;)]
Plot_df &lt;- unique(Plot_df)
m &lt;- leaflet()
m &lt;- addTiles(m)
m &lt;- addMarkers(m,
  lng = Plot_df$Longitude,
  lat = Plot_df$Latitude,
  label = Plot_df$Index,
  popup = paste(Plot_df$Population.Status, Plot_df$Climate, sep = &quot;;&quot;)
)
m
</code></pre>
<pre><code class="language-{=html}">&lt;div class=&quot;leaflet html-widget html-fill-item-overflow-hidden html-fill-item&quot; id=&quot;htmlwidget-9aac1c390aadeb1fd4f9&quot; style=&quot;width:1440px;height:768px;&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;application/json&quot; data-for=&quot;htmlwidget-9aac1c390aadeb1fd4f9&quot;&gt;{&quot;x&quot;:{&quot;options&quot;:{&quot;crs&quot;:{&quot;crsClass&quot;:&quot;L.CRS.EPSG3857&quot;,&quot;code&quot;:null,&quot;proj4def&quot;:null,&quot;projectedBounds&quot;:null,&quot;options&quot;:{}}},&quot;calls&quot;:[{&quot;method&quot;:&quot;addTiles&quot;,&quot;args&quot;:[&quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,null,null,{&quot;minZoom&quot;:0,&quot;maxZoom&quot;:18,&quot;tileSize&quot;:256,&quot;subdomains&quot;:&quot;abc&quot;,&quot;errorTileUrl&quot;:&quot;&quot;,&quot;tms&quot;:false,&quot;noWrap&quot;:false,&quot;zoomOffset&quot;:0,&quot;zoomReverse&quot;:false,&quot;opacity&quot;:1,&quot;zIndex&quot;:1,&quot;detectRetina&quot;:false,&quot;attribution&quot;:&quot;&amp;copy; &lt;a href=\&quot;https://openstreetmap.org\&quot;&gt;OpenStreetMap&lt;\/a&gt; contributors, &lt;a href=\&quot;https://creativecommons.org/licenses/by-sa/2.0/\&quot;&gt;CC-BY-SA&lt;\/a&gt;&quot;}]},{&quot;method&quot;:&quot;addMarkers&quot;,&quot;args&quot;:[[60,54,-25,-21.1,70,55,31,17.25,4,10.5,-51.75],[100,-2,135,55.6,-90,-97,-92,-88.75,-53,-67,-59.17],null,null,null,{&quot;interactive&quot;:true,&quot;draggable&quot;:false,&quot;keyboard&quot;:true,&quot;title&quot;:&quot;&quot;,&quot;alt&quot;:&quot;&quot;,&quot;zIndexOffset&quot;:0,&quot;opacity&quot;:1,&quot;riseOnHover&quot;:false,&quot;riseOffset&quot;:250},[&quot;Native;Continental&quot;,&quot;Native;Coastal&quot;,&quot;Introduced;Continental&quot;,&quot;Introduced;Coastal&quot;,&quot;Introduced;Coastal&quot;,&quot;Introduced;Semi-Coastal&quot;,&quot;Introduced;Coastal&quot;,&quot;Introduced;Coastal&quot;,&quot;Introduced;Coastal&quot;,&quot;Introduced;Coastal&quot;,&quot;Introduced;Coastal&quot;],null,null,null,[&quot;SI&quot;,&quot;UK&quot;,&quot;AU&quot;,&quot;RE&quot;,&quot;NU&quot;,&quot;MA&quot;,&quot;LO&quot;,&quot;BE&quot;,&quot;FG&quot;,&quot;SA&quot;,&quot;FI&quot;],{&quot;interactive&quot;:false,&quot;permanent&quot;:false,&quot;direction&quot;:&quot;auto&quot;,&quot;opacity&quot;:1,&quot;offset&quot;:[0,0],&quot;textsize&quot;:&quot;10px&quot;,&quot;textOnly&quot;:false,&quot;className&quot;:&quot;&quot;,&quot;sticky&quot;:true},null]}],&quot;limits&quot;:{&quot;lat&quot;:[-51.75,70],&quot;lng&quot;:[-97,135]}},&quot;evals&quot;:[],&quot;jsHooks&quot;:[]}&lt;/script&gt;
</code></pre>
<p>Note that you can zoom and drag the above map as well as click the station markers for some additional information.</p>
<h3 id="adding-information">Adding Information</h3>
<p>How do we get the data for this? Well, I wrote an <code>R</code>-Package that does exactly that.</p>
<p>First, said package needs to be installed from my GitHub repository for it. Subsequently, we need to set API Key and User number obtained at the 
<a href="https://cds.climate.copernicus.eu/api-how-to" target="_blank" rel="noopener">Climate Data Store</a>. I have already baked these into my material, so I don&rsquo;t set them here, but include lines of code that ask you for your credentials when copy &amp; pasted over:</p>
<pre><code class="language-r">if (&quot;KrigR&quot; %in% rownames(installed.packages()) == FALSE) { # KrigR check
  Sys.setenv(R_REMOTES_NO_ERRORS_FROM_WARNINGS = &quot;true&quot;)
  devtools::install_github(&quot;https://github.com/ErikKusch/KrigR&quot;)
}
library(KrigR)
#### CDS API (needed for ERA5-Land downloads)
if (!exists(&quot;API_Key&quot;) | !exists(&quot;API_User&quot;)) { # CS API check: if CDS API credentials have not been specified elsewhere
  API_User &lt;- readline(prompt = &quot;Please enter your Climate Data Store API user number and hit ENTER.&quot;)
  API_Key &lt;- readline(prompt = &quot;Please enter your Climate Data Store API key number and hit ENTER.&quot;)
} # end of CDS API check

#### NUMBER OF CORES
if (!exists(&quot;numberOfCores&quot;)) { # Core check: if number of cores for parallel processing has not been set yet
  numberOfCores &lt;- readline(prompt = paste(&quot;How many cores do you want to allocate to these processes? Your machine has&quot;, parallel::detectCores()))
} # end of Core check
</code></pre>
<p>Now that we have the package, we can download some state-of-the-art climate data. I have already prepared all of this in the data directory you downloaded earlier so this step will automatically be skipped:</p>
<pre><code class="language-r">if (!file.exists(file.path(&quot;Data&quot;, &quot;SparrowDataClimate.rds&quot;))) {
  colnames(Plot_df)[1:3] &lt;- c(&quot;Lon&quot;, &quot;Lat&quot;, &quot;ID&quot;) # set column names to be in line with what KrigR wants
  Points_Raw &lt;- download_ERA(
    Variable = &quot;2m_temperature&quot;,
    DataSet = &quot;era5&quot;,
    DateStart = &quot;1982-01-01&quot;,
    DateStop = &quot;2012-12-31&quot;,
    TResolution = &quot;month&quot;,
    TStep = 1,
    Extent = Plot_df, # the point data with Lon and Lat columns
    Buffer = 0.5, # a 0.5 degree buffer should be drawn around each point
    ID = &quot;ID&quot;, # this is the column which holds point IDs
    API_User = API_User,
    API_Key = API_Key,
    Dir = file.path(getwd(), &quot;Data&quot;),
    FileName = &quot;AT_Climatology.nc&quot;
  )
  Points_mean &lt;- calc(Points_Raw, fun = mean)
  Points_sd &lt;- calc(Points_Raw, fun = sd)
  Sparrows_df$TAvg &lt;- as.numeric(extract(x = Points_mean, y = Sparrows_df[, c(&quot;Longitude&quot;, &quot;Latitude&quot;)], buffer = 0.3))
  Sparrows_df$TSD &lt;- as.numeric(extract(x = Points_sd, y = Sparrows_df[, c(&quot;Longitude&quot;, &quot;Latitude&quot;)], buffer = 0.3))
  saveRDS(Sparrows_df, file.path(&quot;Data&quot;, &quot;SparrowDataClimate.rds&quot;))
} else {
  Sparrows_df &lt;- readRDS(file.path(&quot;Data&quot;, &quot;SparrowDataClimate.rds&quot;))
}
</code></pre>
<p>We have now effectively added two more variables to the data set:</p>
<ol start="19">
<li><code>TAvg</code> [<em>Numeric</em>] - Average air temperature for a 30-year time-period</li>
<li><code>TSD</code> [<em>Numeric</em>] - Standard deviation of mean monthly air temperature for a 30-year time-period</li>
</ol>
<p>Now we have the data set we will look at for the rest of the exercises in this seminar series. But how did we get here? Find the answer 
<a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/">here</a>.</p>
<h3 id="hypotheses">Hypotheses</h3>
<p>Let&rsquo;s consider the following two hypotheses for our exercises for this simulated research project:</p>
<ol>
<li><strong>Sparrow Morphology</strong> is determined by:<br>
A. <em>Climate Conditions</em> with sparrows in stable, warm environments fairing better than those in colder, less stable ones.<br>
B. <em>Competition</em> with sparrows in small flocks doing better than those in big flocks.<br>
C. <em>Predation</em> with sparrows under pressure of predation doing worse than those without.</li>
<li><strong>Sites</strong>  accurately represent <strong>sparrow morphology</strong>. This may mean:<br>
A. <em>Population status</em> as inferred through morphology.<br>
B. <em>Site index</em> as inferred through morphology.<br>
C. <em>Climate</em> as inferred through morphology.</li>
</ol>
<p>We try to answer these over the next few sessions.</p>
<h2 id="sessioninfo">SessionInfo</h2>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] KrigR_0.1.2       terra_1.7-21      httr_1.4.5        stars_0.6-0       abind_1.4-5       fasterize_1.0.4   sf_1.0-12         lubridate_1.9.2   automap_1.1-9     doSNOW_1.0.20    
## [11] snow_0.4-4        doParallel_1.0.17 iterators_1.0.14  foreach_1.5.2     rgdal_1.6-5       raster_3.6-20     sp_1.6-0          stringr_1.5.0     keyring_1.3.1     ecmwfr_1.5.0     
## [21] ncdf4_1.21        leaflet_2.1.2    
## 
## loaded via a namespace (and not attached):
##  [1] xts_0.13.0         R.cache_0.16.0     tools_4.2.3        bslib_0.4.2        utf8_1.2.3         R6_2.5.1           KernSmooth_2.23-20 DBI_1.1.3          colorspace_2.1-0   tidyselect_1.2.0  
## [11] compiler_4.2.3     cli_3.6.0          gstat_2.1-0        bookdown_0.33      sass_0.4.5         scales_1.2.1       classInt_0.4-9     proxy_0.4-27       digest_0.6.31      rmarkdown_2.20    
## [21] R.utils_2.12.2     pkgconfig_2.0.3    htmltools_0.5.4    styler_1.9.1       fastmap_1.1.1      htmlwidgets_1.6.1  rlang_1.0.6        rstudioapi_0.14    FNN_1.1.3.2        jquerylib_0.1.4   
## [31] generics_0.1.3     zoo_1.8-11         jsonlite_1.8.4     crosstalk_1.2.0    dplyr_1.1.0        R.oo_1.25.0        magrittr_2.0.3     Rcpp_1.0.10        munsell_0.5.0      fansi_1.0.4       
## [41] lifecycle_1.0.3    R.methodsS3_1.8.2  stringi_1.7.12     yaml_2.3.7         plyr_1.8.8         grid_4.2.3         lattice_0.20-45    knitr_1.42         pillar_1.8.1       spacetime_1.2-8   
## [51] codetools_0.2-19   glue_1.6.2         evaluate_0.20      blogdown_1.16      vctrs_0.5.2        gtable_0.3.1       purrr_1.0.1        reshape_0.8.9      assertthat_0.2.1   cachem_1.0.7      
## [61] ggplot2_3.4.1      xfun_0.37          lwgeom_0.2-11      e1071_1.7-13       class_7.3-21       tibble_3.2.0       intervals_0.15.3   memoise_2.0.1      units_0.8-1        timechange_0.2.0  
## [71] ellipsis_0.3.2
</code></pre>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
</div>



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/excursions-into-biostatistics/3_coding-practices-life-with-r/" rel="next">Coding Practices - Life with R</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/excursions-into-biostatistics/research-project/" rel="prev">Research Project</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 2020-02-27</p>

          





          


          


  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/courses/excursions-into-biostatistics/research-project/">Research Project</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/classifications-order-from-chaos/">Classifications</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/">Data Handling and Data Assumptions</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/excursion-into-biostatistics/">Model Selection</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/regressions-correlations-for-the-advanced/">Regressions</a></li>
      
    </ul>
  </div>
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    © 2024
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
