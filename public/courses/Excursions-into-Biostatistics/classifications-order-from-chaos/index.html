<!DOCTYPE html><html lang="en-gb" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Erik Kusch">

  
  
  
    
  
  <meta name="description" content="These are exercises and solutions meant as a compendium to my talk on Classifications.">

  
  <link rel="alternate" hreflang="en-gb" href="https://www.erikkusch.com/courses/excursions-into-biostatistics/classifications-order-from-chaos/">

  


  
  
  
  <meta name="theme-color" content="#858383">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186216138-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186216138-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.erikkusch.com/courses/excursions-into-biostatistics/classifications-order-from-chaos/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ErikKusch">
  <meta property="twitter:creator" content="@ErikKusch">
  
  <meta property="og:site_name" content="Erik Kusch">
  <meta property="og:url" content="https://www.erikkusch.com/courses/excursions-into-biostatistics/classifications-order-from-chaos/">
  <meta property="og:title" content="Classifications | Erik Kusch">
  <meta property="og:description" content="These are exercises and solutions meant as a compendium to my talk on Classifications."><meta property="og:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg">
  <meta property="twitter:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg"><meta property="og:locale" content="en-gb">
  
    
      <meta property="article:published_time" content="2021-02-27T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-02-27T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Classifications | Erik Kusch</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses & Workshops</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/krigr/"><span>KrigR - State-of-the-Art Climate Data within R</span></a>
            
              <a class="dropdown-item" href="/courses/gbif/"><span>Accessing and Referencing GBIF Data for Research</span></a>
            
              <a class="dropdown-item" href="/courses/rethinking/"><span>Statistical Rethinking - Introduction to Bayesian Statistics</span></a>
            
              <a class="dropdown-item" href="/courses/bayes-nets/"><span>Bayesian Networks - Causality through Bayesian Approaches</span></a>
            
              <a class="dropdown-item" href="/courses/biostat101/"><span>Biostats 101 - An Introduction to Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/excursions-into-biostatistics/"><span>Biostats 301 - Excursions into Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/bftp-biome-detection/"><span>BFTP - First Steps in Macroecology in R</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/media/CV_ErikKusch.html" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/excursions-into-biostatistics/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/excursions-into-biostatistics/1_biostatistics-wait.-what/">Seminars</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/excursions-into-biostatistics/1_biostatistics-wait.-what/">Biostatistics - Wait... What?!</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/2_statistical-terminology-the-basics-misconceptions-and-pedantics/">Statistical Terminology</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/3_coding-practices-life-with-r/">Coding Practices - Life with R</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/research-project/">Research Project for our Exercises</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/">Data Handling and Data Assumptions</a>
      </li>
      
      <li class="active">
        <a href="/courses/excursions-into-biostatistics/classifications-order-from-chaos/">Classifications - Order from Chaos</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/regressions-correlations-for-the-advanced/">Regressions - Correlations for the Advanced</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/excursion-into-biostatistics/">Model Selection and Statistical Significance</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/8_statistical-significance-in-biology-conventions-abstractions-and-the-future/">Statistical Significance in Biology</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/9_rmarkdown-manuscript-workflow-revisited/">RMarkdown - Manuscript Workflow Revisited</a>
      </li>
      
      <li >
        <a href="/courses/excursions-into-biostatistics/10_troubleshooting_r-isolating-issues-and-asking-questions/">Troubleshooting R - Isolating Issues and Asking Questions</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#theory">Theory</a></li>
    <li><a href="#our-resarch-project">Our Resarch Project</a>
      <ul>
        <li><a href="#the-data">The Data</a></li>
        <li><a href="#reading-the-data-into-r">Reading the Data into <code>R</code></a></li>
        <li><a href="#hypotheses">Hypotheses</a></li>
      </ul>
    </li>
    <li><a href="#r-environment"><code>R</code> Environment</a></li>
    <li><a href="#logistic-regression">Logistic Regression</a>
      <ul>
        <li><a href="#binary-logistic-regression">Binary Logistic Regression</a></li>
        <li><a href="#ordinal-logistic-regression">Ordinal Logistic Regression</a></li>
      </ul>
    </li>
    <li><a href="#k-means-clustering">K-Means Clustering</a>
      <ul>
        <li><a href="#population-status-classifier">Population Status Classifier</a></li>
        <li><a href="#site-classifier">Site Classifier</a></li>
        <li><a href="#climate-classifier">Climate Classifier</a></li>
        <li><a href="#optimal-model">Optimal Model</a></li>
        <li><a href="#summary-of-k-means-clustering">Summary of K-Means Clustering</a></li>
      </ul>
    </li>
    <li><a href="#hierarchical-clustering">Hierarchical Clustering</a>
      <ul>
        <li><a href="#population-status-classifier-1">Population Status Classifier</a></li>
        <li><a href="#site-classifier-1">Site Classifier</a></li>
        <li><a href="#climate-classifier-1">Climate Classifier</a></li>
        <li><a href="#summary-of-hierarchical-clustering">Summary of Hierarchical Clustering</a></li>
      </ul>
    </li>
    <li><a href="#random-forest">Random Forest</a>
      <ul>
        <li><a href="#population-status-classifier-2">Population Status Classifier</a></li>
        <li><a href="#site-classifier-2">Site Classifier</a></li>
        <li><a href="#climate-classifier-2">Climate Classifier</a></li>
      </ul>
    </li>
    <li><a href="#final-models">Final Models</a></li>
    <li><a href="#sessioninfo">SessionInfo</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Classifications</h1>

          <div class="article-style">
            <h2 id="theory">Theory</h2>
<p>These are exercises and solutions meant as a compendium to my talk on Model Selection and Model Building.</p>
<p>I have prepared some <a href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/courses/Excursions-into-Biostatistics/Classifications---Order-from-Chaos.html" target="_blank"> Lecture Slides </a> for this session.</p>
<h2 id="our-resarch-project">Our Resarch Project</h2>
<p>Today, we are looking at a big (and entirely fictional) data base of the common house sparrow (<em>Passer domesticus</em>). In particular, we are interested in the <strong>Evolution of <em>Passer domesticus</em> in Response to Climate Change</strong> which was previously explained <a href="/courses/excursions-into-biostatistics/research-project/" target="_blank"> here</a>.</p>
<h3 id="the-data">The Data</h3>
<p>I have created a large data set for this exercise which is available <a href="https://github.com/ErikKusch/Homepage/raw/master/content/courses/excursions-into-biostatistics/Data.rar" target="_blank"> here</a> and we previously cleaned up so that is now usable <a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/" target="_blank"> here</a>.</p>
<h3 id="reading-the-data-into-r">Reading the Data into <code>R</code></h3>
<p>Let&rsquo;s start by reading the data into <code>R</code> and taking an initial look at it:</p>
<pre><code class="language-r">Sparrows_df &lt;- readRDS(file.path(&quot;Data&quot;, &quot;SparrowDataClimate.rds&quot;))
head(Sparrows_df)
</code></pre>
<pre><code>##   Index Latitude Longitude     Climate Population.Status Weight Height Wing.Chord Colour    Sex Nesting.Site Nesting.Height Number.of.Eggs Egg.Weight Flock Home.Range Predator.Presence Predator.Type
## 1    SI       60       100 Continental            Native  34.05  12.87       6.67  Brown   Male         &lt;NA&gt;             NA             NA         NA     B      Large               Yes         Avian
## 2    SI       60       100 Continental            Native  34.86  13.68       6.79   Grey   Male         &lt;NA&gt;             NA             NA         NA     B      Large               Yes         Avian
## 3    SI       60       100 Continental            Native  32.34  12.66       6.64  Black Female        Shrub          35.60              1       3.21     C      Large               Yes         Avian
## 4    SI       60       100 Continental            Native  34.78  15.09       7.00  Brown Female        Shrub          47.75              0         NA     E      Large               Yes         Avian
## 5    SI       60       100 Continental            Native  35.01  13.82       6.81   Grey   Male         &lt;NA&gt;             NA             NA         NA     B      Large               Yes         Avian
## 6    SI       60       100 Continental            Native  32.36  12.67       6.64  Brown Female        Shrub          32.47              1       3.17     E      Large               Yes         Avian
##       TAvg      TSD
## 1 269.9596 15.71819
## 2 269.9596 15.71819
## 3 269.9596 15.71819
## 4 269.9596 15.71819
## 5 269.9596 15.71819
## 6 269.9596 15.71819
</code></pre>
<h3 id="hypotheses">Hypotheses</h3>
<p>Let&rsquo;s remember our hypotheses:</p>
<ol>
<li><strong>Sparrow Morphology</strong> is determined by:<br>
A. <em>Climate Conditions</em> with sparrows in stable, warm environments fairing better than those in colder, less stable ones.<br>
B. <em>Competition</em> with sparrows in small flocks doing better than those in big flocks.<br>
C. <em>Predation</em> with sparrows under pressure of predation doing worse than those without.</li>
<li><strong>Sites</strong>  accurately represent <strong>sparrow morphology</strong>. This may mean:<br>
A. <em>Population status</em> as inferred through morphology.<br>
B. <em>Site index</em> as inferred through morphology.<br>
C. <em>Climate</em> as inferred through morphology.</li>
</ol>
<p>Quite obviously, <strong>hypothesis 2</strong> is the only one lending itself well to classification exercises. In fact, what we want to answer is the question: <em>&ldquo;Can we successfully classify populations at different sites according to their morphological expressions?&quot;</em>.</p>
<h2 id="r-environment"><code>R</code> Environment</h2>
<p>For this exercise, we will need the following packages:</p>
<pre><code class="language-r">install.load.package &lt;- function(x) {
  if (!require(x, character.only = TRUE)) {
    install.packages(x, repos = &quot;http://cran.us.r-project.org&quot;)
  }
  require(x, character.only = TRUE)
}
package_vec &lt;- c(
  &quot;ggplot2&quot;, # for visualisation
  &quot;mclust&quot;, # for k-means clustering,
  &quot;vegan&quot;, # for distance matrices in hierarchical clustering
  &quot;rpart&quot;, # for decision trees
  &quot;rpart.plot&quot;, # for plotting decision trees
  &quot;randomForest&quot;, # for randomForest classifier
  &quot;car&quot;, # check multicollinearity
  &quot;MASS&quot; # for ordinal logistic regression
)
sapply(package_vec, install.load.package)
</code></pre>
<pre><code>##      ggplot2       mclust        vegan        rpart   rpart.plot randomForest          car         MASS 
##         TRUE         TRUE         TRUE         TRUE         TRUE         TRUE         TRUE         TRUE
</code></pre>
<p>Using the above function is way more sophisticated than the usual <code>install.packages()</code> &amp; <code>library()</code> approach since it automatically detects which packages require installing and only install these thus not overwriting already installed packages.</p>
<h2 id="logistic-regression">Logistic Regression</h2>
<p>Remember the <strong>Assumptions of Logistic Regression</strong>:</p>
<ol>
<li>Absence of influential outliers</li>
<li>Absence of multi-collinearity</li>
<li>Predictor Variables and log odds are related in a linear fashion</li>
</ol>
<h3 id="binary-logistic-regression">Binary Logistic Regression</h3>
<p>Binary Logistic regression only accommodates binary outcomes. This leaves only one of our hypotheses open for investigation - <strong>2.A.</strong> <em>Population Status</em> - since this is the only response variable boasting two levels.</p>
<p>To reduce the effect of as many confounding variables as possible, I reduce the data set to just those observations belonging to our station in Siberia and Manitoba. Both are located at very similar latitudes. They really only differ in their climate condition and the population status:</p>
<pre><code class="language-r">LogReg_df &lt;- Sparrows_df[Sparrows_df$Index == &quot;MA&quot; | Sparrows_df$Index == &quot;SI&quot;, c(&quot;Population.Status&quot;, &quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)]
LogReg_df$PS &lt;- as.numeric(LogReg_df$Population.Status) - 1 # make climate numeric for model
</code></pre>
<h4 id="initial-model--collinearity">Initial Model &amp; Collinearity</h4>
<p>Let&rsquo;s start with the biggest model we can build here and then assess if our assumptions are met:</p>
<pre><code class="language-r">H2_LogReg_mod &lt;- glm(PS ~ Weight + Height + Wing.Chord,
  data = LogReg_df,
  family = binomial(link = &quot;logit&quot;),
)
summary(H2_LogReg_mod)
</code></pre>
<pre><code>## 
## Call:
## glm(formula = PS ~ Weight + Height + Wing.Chord, family = binomial(link = &quot;logit&quot;), 
##     data = LogReg_df)
## 
## Deviance Residuals: 
##        Min          1Q      Median          3Q         Max  
## -2.657e-05  -2.110e-08  -2.110e-08   2.110e-08   2.855e-05  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  1.557e+03  3.312e+07   0.000    1.000
## Weight       7.242e+01  3.735e+04   0.002    0.998
## Height       2.153e+01  1.061e+06   0.000    1.000
## Wing.Chord  -6.247e+02  6.928e+06   0.000    1.000
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1.8437e+02  on 132  degrees of freedom
## Residual deviance: 6.8926e-09  on 129  degrees of freedom
## AIC: 8
## 
## Number of Fisher Scoring iterations: 25
</code></pre>
<p>Well&hellip; nothing here is significant. Let&rsquo;s see what the culprit might be. With morphological traits, you are often looking at a whole set of collinearity, so let&rsquo;s start by investigating that:</p>
<pre><code class="language-r">vif(H2_LogReg_mod)
</code></pre>
<pre><code>##      Weight      Height  Wing.Chord 
##    9.409985 6550.394451 6342.683550
</code></pre>
<p>A Variance Inflation Factor (VIF) value of $\geq5-10$ is seen as identifying problematic collinearity. Quite obviously, this is the case. We need to throw away some predictors. I only want to keep <code>Weight</code>.</p>
<h4 id="weight-model-and-further-assumptions"><code>Weight</code> Model and Further Assumptions</h4>
<p>Let&rsquo;s run a simplified model that just used <code>Weight</code> as a predictor:</p>
<pre><code class="language-r">H2_LogReg_mod &lt;- glm(PS ~ Weight,
  data = LogReg_df,
  family = binomial(link = &quot;logit&quot;)
)
summary(H2_LogReg_mod)
</code></pre>
<pre><code>## 
## Call:
## glm(formula = PS ~ Weight, family = binomial(link = &quot;logit&quot;), 
##     data = LogReg_df)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1980  -0.5331  -0.1235   0.5419   1.9067  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -46.3244     7.8319  -5.915 3.32e-09 ***
## Weight        1.4052     0.2374   5.920 3.23e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 184.37  on 132  degrees of freedom
## Residual deviance: 105.08  on 131  degrees of freedom
## AIC: 109.08
## 
## Number of Fisher Scoring iterations: 5
</code></pre>
<p>A significant effect, huzzah! We still need to test for our assumptions, however. Checking for <strong>multicollinearity</strong> makes no sense since we only use one predictor, so we can skip that.</p>
<p><strong>Linear Relationship</strong> between predictor(s) and log-odds of the output can be assessed as follows:</p>
<pre><code class="language-r">probabilities &lt;- predict(H2_LogReg_mod, type = &quot;response&quot;) # predict model response on original data
LogReg_df$Probs &lt;- probabilities # safe probabilities to data frame
LogReg_df$LogOdds &lt;- log(probabilities / (1 - probabilities)) # calculate log-odds
## Plot Log-Odds vs. Predictor
ggplot(data = LogReg_df, aes(x = Weight, y = LogOdds)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = TRUE) +
  theme_bw()
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-7-1.png" width="1440" /></p>
<p>That is clearly linear relationship!</p>
<p>Moving on to our final assumption, we want to assess whether there are influential <strong>Outliers</strong>. For this, we want to look at the <em>Cook&rsquo;s distance</em> as well as the <em>standardised residuals</em> per observation:</p>
<pre><code class="language-r">## Cook's distance
plot(H2_LogReg_mod, which = 4, id.n = 3)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-8-1.png" width="1440" /></p>
<pre><code class="language-r">## Standardises Residuals
Outlier_df &lt;- data.frame(
  Residuals = resid(H2_LogReg_mod),
  Index = 1:nrow(LogReg_df),
  Outcome = factor(LogReg_df$PS)
)
Outlier_df$Std.Resid &lt;- scale(Outlier_df$Residuals)
# Plot Residuals
ggplot(Outlier_df, aes(Outcome, Std.Resid)) +
  geom_boxplot() +
  theme_bw()
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-8-2.png" width="1440" />
Both of these plots do not highlight any worrying influential outliers. An influential outliers would manifest with a prominent standardises residual ($|Std.Resid|\sim3$)/Cook&rsquo;s distance.</p>
<p>Let&rsquo;s finally plot what the model predicts:</p>
<pre><code class="language-r">ggplot(data = LogReg_df, aes(x = Weight, y = LogReg_df$PS)) +
  geom_point() +
  theme_bw() +
  geom_smooth(
    data = LogReg_df, aes(x = Weight, y = Probs),
    method = &quot;glm&quot;,
    method.args = list(family = &quot;binomial&quot;),
    se = TRUE
  ) +
  labs(y = &quot;Introduced Population&quot;)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-9-1.png" width="1440" /></p>
<h3 id="ordinal-logistic-regression">Ordinal Logistic Regression</h3>
<p>Ordinal Logistic regression allows for multiple levels of the response variable so long as they are on an ordinal scale. Here, we could test all of our above hypotheses. However, I&rsquo;d like to stick with <strong>2.C.</strong> <em>Climate</em> for this example.</p>
<p>Again, to reduce the effect of as many confounding variables as possible, I reduce the data set to just those observations belonging to our station in Siberia, Manitoba, and also the United Kingdom this time. All three are located at very similar latitudes. They really only differ in their climate condition and the population status:</p>
<pre><code class="language-r">LogReg_df &lt;- Sparrows_df[Sparrows_df$Index == &quot;UK&quot; | Sparrows_df$Index == &quot;MA&quot; | Sparrows_df$Index == &quot;SI&quot;, c(&quot;Climate&quot;, &quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)]
LogReg_df$CL &lt;- factor(as.numeric(LogReg_df$Climate) - 1) # make climate factored numeric for model
</code></pre>
<h4 id="initial-model--collinearity-1">Initial Model &amp; Collinearity</h4>
<p>Let&rsquo;s start with the biggest model we can build here and then assess if our assumptions are met:</p>
<pre><code class="language-r">H2_LogReg_mod &lt;- polr(CL ~ Weight + Height + Wing.Chord,
  data = LogReg_df,
  Hess = TRUE
)
summary_table &lt;- coef(summary(H2_LogReg_mod))
pval &lt;- pnorm(abs(summary_table[, &quot;t value&quot;]), lower.tail = FALSE) * 2
summary_table &lt;- cbind(summary_table, &quot;p value&quot; = round(pval, 6))
summary_table
</code></pre>
<pre><code>##                   Value Std. Error      t value p value
## Weight       -0.4595719 0.09750018    -4.713549   2e-06
## Height       25.0808034 0.19522606   128.470573   0e+00
## Wing.Chord -164.1103857 0.51246129  -320.239573   0e+00
## 0|1        -788.2133893 0.11008589 -7159.985419   0e+00
## 1|2        -786.8019284 0.18747890 -4196.749302   0e+00
</code></pre>
<p>Well&hellip; a lot here is significant. We identified <strong>multicollinearity</strong> as a problem earlier. Let&rsquo;s investigate that again:</p>
<pre><code class="language-r">vif(H2_LogReg_mod)
</code></pre>
<pre><code>##     Weight     Height Wing.Chord 
##   431.6796   294.6353   536.5452
</code></pre>
<p>Horrible!. A Variance Inflation Factor (VIF) value of $\geq5-10$ is seen as identifying problematic collinearity. Quite obviously, this is the case. We need to throw away some predictors. I only want to keep <code>Weight</code>.</p>
<h4 id="weight-model-and-further-assumptions-1"><code>Weight</code> Model and Further Assumptions</h4>
<p>Let&rsquo;s run a simplified model that just used <code>Weight</code> as a predictor:</p>
<pre><code class="language-r">H2_LogReg_mod &lt;- polr(CL ~ Weight,
  data = LogReg_df,
  Hess = TRUE
)
summary_table &lt;- coef(summary(H2_LogReg_mod))
pval &lt;- pnorm(abs(summary_table[, &quot;t value&quot;]), lower.tail = FALSE) * 2
summary_table &lt;- cbind(summary_table, &quot;p value&quot; = round(pval, 6))
summary_table
</code></pre>
<pre><code>##               Value Std. Error      t value  p value
## Weight -0.020768177  0.0761669 -0.272666718 0.785109
## 0|1    -1.354848455  2.5131706 -0.539099272 0.589818
## 1|2     0.009549511  2.5112093  0.003802754 0.996966
</code></pre>
<p>Well&hellip; this model doesn&rsquo;t help us at all in understanding climate through morphology of our sparrows. Let&rsquo;s abandon this and move on to classification methods which are much better suited to this task.</p>
<h2 id="k-means-clustering">K-Means Clustering</h2>
<p>K-Means clustering is incredibly potent in identifying a number of appropriate clusters, their attributes, and sort observations into appropriate clusters.</p>
<h3 id="population-status-classifier">Population Status Classifier</h3>
<p>Let&rsquo;s start with understanding population status through morphological traits:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;, &quot;Population.Status&quot;)]
H2_PS_mclust &lt;- Mclust(Morph_df[-4], G = length(unique(Morph_df[, 4])))
plot(H2_PS_mclust, what = &quot;uncertainty&quot;)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-14-1.png" width="1440" /></p>
<p>As we can see, K-means clustering is able to really neatly identify two groups in our data. But do they actually belong do the right groups of <code>Population.Status</code>? We&rsquo;ll find out in <a href="/courses/excursions-into-biostatistics/excursion-into-biostatistics/" target="_blank"> Model Selection and Validation</a>.</p>
<h3 id="site-classifier">Site Classifier</h3>
<p>On to our site index classification. Running the k-means clustering algorithm returns:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;, &quot;Index&quot;)]
H2_Index_mclust &lt;- Mclust(Morph_df[-4], G = length(unique(Morph_df[, 4])))
plot(H2_Index_mclust, what = &quot;uncertainty&quot;)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-15-1.png" width="1440" /></p>
<p>That&rsquo;s a pretty bad classification. I would not place trust in these clusters seeing how much they overlap.</p>
<h3 id="climate-classifier">Climate Classifier</h3>
<p>Lastly, turning to our climate classification using k-means classification:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;, &quot;Climate&quot;)]
H2_Climate_mclust &lt;- Mclust(Morph_df[-4], G = length(unique(Morph_df[, 4])))
plot(H2_Climate_mclust, what = &quot;uncertainty&quot;)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-16-1.png" width="1440" />
These clusters are decent although there is quite a bit of overlap between the blue and red cluster.</p>
<h3 id="optimal-model">Optimal Model</h3>
<p>K-means clustering is also able to identify the most &ldquo;appropriate&rdquo; number of clusters given the data and uncertainty of classification:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)]
dataBIC &lt;- mclustBIC(Morph_df)
summary(dataBIC) # show summary of top-ranking models
</code></pre>
<pre><code>## Best BIC values:
##             VVV,7     EVV,7     EVV,8
## BIC      63.39237 -304.1895 -336.0531
## BIC diff  0.00000 -367.5819 -399.4455
</code></pre>
<pre><code class="language-r">plot(dataBIC)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-17-1.png" width="1440" /></p>
<pre><code class="language-r">G &lt;- as.numeric(strsplit(names(summary(dataBIC))[1], &quot;,&quot;)[[1]][2])
H2_Opt_mclust &lt;- Mclust(Morph_df, # data for the cluster model
  G = G # BIC index for model to be built
)
H2_Opt_mclust[[&quot;parameters&quot;]][[&quot;mean&quot;]] # mean values of clusters
</code></pre>
<pre><code>##                 [,1]      [,2]     [,3]      [,4]      [,5]      [,6]      [,7]
## Weight     34.830000 32.677280 33.63023 31.354892 30.146417 22.585240 22.796014
## Height     13.641765 13.570427 14.20721 14.317070 14.085826 18.847550 19.036621
## Wing.Chord  6.787059  6.780954  6.99186  7.044881  6.965047  8.576106  8.609035
</code></pre>
<pre><code class="language-r">plot(H2_Opt_mclust, what = &quot;uncertainty&quot;)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-17-2.png" width="1440" /></p>
<p>Here, K-means clustering would have us settle on 7 clusters. That does not coincide with anything we could really test for at this point. COnclusively, this model goes into the category of &ldquo;Nice to have, but ultimately useless here&rdquo;.</p>
<h3 id="summary-of-k-means-clustering">Summary of K-Means Clustering</h3>
<p>So what do we take from this? Well&hellip; Population status was well explained all morphological traits and so would in turn also do a good job of being a proxy for the other when doing mixed regression models, for example. Hence, we might want to include this variable in future <a href="/courses/excursions-into-biostatistics/regressions-correlations-for-the-advanced/" target="_blank"> Regression Models</a>.</p>
<h2 id="hierarchical-clustering">Hierarchical Clustering</h2>
<p>Moving on to hierarchical clustering, we luckily only need to create a few trees to start with:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)] # selecting morphology data
dist_mat &lt;- dist(Morph_df) # distance matrix
## Hierarchical clustering using different linkages
H2_Hierachical_clas1 &lt;- hclust(dist_mat, method = &quot;complete&quot;)
H2_Hierachical_clas2 &lt;- hclust(dist_mat, method = &quot;single&quot;)
H2_Hierachical_clas3 &lt;- hclust(dist_mat, method = &quot;average&quot;)
## Plotting Hierarchies
par(mfrow = c(1, 3))
plot(H2_Hierachical_clas1, main = &quot;complete&quot;)
plot(H2_Hierachical_clas2, main = &quot;single&quot;)
plot(H2_Hierachical_clas3, main = &quot;average&quot;)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-18-1.png" width="1440" /></p>
<p>Here, you can see that the type of linkage employed by your hierarchical approach is very important as to how the hierarchy ends up looking like. For now, we run with all of them.</p>
<h3 id="population-status-classifier-1">Population Status Classifier</h3>
<p>For our population status classifier, let&rsquo;s obtain our data and cluster number we are after:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;, &quot;Population.Status&quot;)]
G &lt;- length(unique(Morph_df[, 4]))
</code></pre>
<p>Now we can look at how well our different Hierarchies fair at explaining these categories when cut at the point where the same number of categories is present in the tree:</p>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas1, k = G) # cut tree
table(clusterCut, Morph_df$Population.Status) # assess fit
</code></pre>
<pre><code>##           
## clusterCut Introduced Native
##          1        682    134
##          2        250      0
</code></pre>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas2, k = G) # cut tree
table(clusterCut, Morph_df$Population.Status) # assess fit
</code></pre>
<pre><code>##           
## clusterCut Introduced Native
##          1        682    134
##          2        250      0
</code></pre>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas3, k = G) # cut tree
table(clusterCut, Morph_df$Population.Status) # assess fit
</code></pre>
<pre><code>##           
## clusterCut Introduced Native
##          1        682    134
##          2        250      0
</code></pre>
<p>Interestingly enough, no matter the linkage, all of these approaches get Introduced and Native populations confused in the first group, but not the second.</p>
<p>Let&rsquo;s look at the decisions that we could make when following a decision tree for this example:</p>
<pre><code class="language-r">H2_PS_decision &lt;- rpart(Population.Status ~ ., data = Morph_df)
rpart.plot(H2_PS_decision)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-21-1.png" width="1440" /></p>
<p>Following this decision tree we first ask <em>&ldquo;Is our sparrow lighter than 35g?&quot;</em>. If the answer is yes, we move to the left and ask the question <em>&ldquo;Is the wing span of our sparrow greater/equal than 6.9cm?&quot;</em>. If the answer is yes, we move to the left and assign this sparrow to an introduced population status. 62% of all observations are in this node and to 2% we believe that this node might actually be a Native node. All other nodes are explained accordingly. More about their interpretation can be found in this 
<a href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;ved=2ahUKEwizk67jmJDvAhUnMuwKHbaiD90QFjAAegQIARAD&amp;url=http%3A%2F%2Fwww.milbo.org%2Frpart-plot%2Fprp.pdf&amp;usg=AOvVaw2DpMfeZC2yVdRaYZBXBA8K" target="_blank" rel="noopener">PDF Manual</a>.</p>
<h3 id="site-classifier-1">Site Classifier</h3>
<p>Moving on to the site index classifier, we need our data and number of clusters:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;, &quot;Index&quot;)]
G &lt;- length(unique(Morph_df[, 4]))
</code></pre>
<p>Looking at our different outputs:</p>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas1, k = G) # cut tree
table(clusterCut, Morph_df$Index) # assess fit
</code></pre>
<pre><code>##           
## clusterCut  AU  BE  FG  FI  LO  MA  NU  RE  SA  SI  UK
##         1   24   0   0  21   0  15  17   0   0  22  13
##         2   17   0   0   5   3   7   6   0   0  31   5
##         3   19   0   0  29  12  22  21   0   0  13  25
##         4   24  26   0   2  33   5   7  32  16   0  12
##         5    3   0   0  12   4  18  13   0   0   0  13
##         6    0  60   0   0  20   0   0  49  77   0   0
##         7    0  19   0   0   9   0   0  14  21   0   0
##         8    0   0  80   0   0   0   0   0   0   0   0
##         9    0   0 138   0   0   0   0   0   0   0   0
##         10   0   0  16   0   0   0   0   0   0   0   0
##         11   0   0  16   0   0   0   0   0   0   0   0
</code></pre>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas2, k = G) # cut tree
table(clusterCut, Morph_df$Index) # assess fit
</code></pre>
<pre><code>##           
## clusterCut  AU  BE  FG  FI  LO  MA  NU  RE  SA  SI  UK
##         1    0   0   0   0   0   0   0   0   0  28   0
##         2   87 102   0  69  80  67  64  95 112  32  68
##         3    0   0   0   0   0   0   0   0   0   4   0
##         4    0   0   0   0   0   0   0   0   0   2   0
##         5    0   0   0   0   1   0   0   0   0   0   0
##         6    0   1   0   0   0   0   0   0   0   0   0
##         7    0   2   0   0   0   0   0   0   0   0   0
##         8    0   0 122   0   0   0   0   0   0   0   0
##         9    0   0 126   0   0   0   0   0   0   0   0
##         10   0   0   2   0   0   0   0   0   0   0   0
##         11   0   0   0   0   0   0   0   0   2   0   0
</code></pre>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas3, k = G) # cut tree
table(clusterCut, Morph_df$Index) # assess fit
</code></pre>
<pre><code>##           
## clusterCut  AU  BE  FG  FI  LO  MA  NU  RE  SA  SI  UK
##         1   44   0   0  15  14  15  22   0   0  45  19
##         2   42  31   0  50  50  49  40  27   0  12  44
##         3    1   0   0   0   0   0   0   0   0   5   0
##         4    0   0   0   0   0   0   0   0   0   4   0
##         5    0   6   0   4   9   3   2   1   0   0   5
##         6    0  34   0   0   0   0   0  35  81   0   0
##         7    0  21   0   0   8   0   0  27  23   0   0
##         8    0  13   0   0   0   0   0   5  10   0   0
##         9    0   0 106   0   0   0   0   0   0   0   0
##         10   0   0 134   0   0   0   0   0   0   0   0
##         11   0   0  10   0   0   0   0   0   0   0   0
</code></pre>
<p>We can now see clearly how different linkages have a major impact in determining how our hierarchy groups different observations. I won&rsquo;t go into interpretations here to save time and energy since these outputs are so busy.</p>
<p>Our decision tree is also excrutiatingly busy:</p>
<pre><code class="language-r">H2_Index_decision &lt;- rpart(Index ~ ., data = Morph_df)
rpart.plot(H2_Index_decision)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-24-1.png" width="1440" /></p>
<h3 id="climate-classifier-1">Climate Classifier</h3>
<p>Back over to our climate classifier:</p>
<pre><code class="language-r">Morph_df &lt;- Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;, &quot;Climate&quot;)]
G &lt;- length(unique(Morph_df[, 4]))
</code></pre>
<p>Let&rsquo;s look at how the different linkages impact our results:</p>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas1, k = G) # cut tree
table(clusterCut, Morph_df$Climate) # assess fit
</code></pre>
<pre><code>##           
## clusterCut Coastal Continental Semi-Coastal
##          1     577         105           60
##          2      19          48            7
##          3     250           0            0
</code></pre>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas2, k = G) # cut tree
table(clusterCut, Morph_df$Climate) # assess fit
</code></pre>
<pre><code>##           
## clusterCut Coastal Continental Semi-Coastal
##          1     595         153           67
##          2       1           0            0
##          3     250           0            0
</code></pre>
<pre><code class="language-r">clusterCut &lt;- cutree(H2_Hierachical_clas3, k = G) # cut tree
table(clusterCut, Morph_df$Climate) # assess fit
</code></pre>
<pre><code>##           
## clusterCut Coastal Continental Semi-Coastal
##          1     596         153           67
##          2     240           0            0
##          3      10           0            0
</code></pre>
<p>All of our linkage types have problems discerning Coastal types. I wager that is because of a ton of confounding effects which drive morphological traits in addition to climate types.</p>
<p>Here&rsquo;s another look at a decision tree:</p>
<pre><code class="language-r">H2_Climate_decision &lt;- rpart(Climate ~ ., data = Morph_df)
rpart.plot(H2_Climate_decision)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-27-1.png" width="1440" /></p>
<h3 id="summary-of-hierarchical-clustering">Summary of Hierarchical Clustering</h3>
<p>We have seen that site indices may hold some explanatory power regarding sparrow morphology, but the picture is very complex. We may want to keep them in mind as random effects for future models (don&rsquo;t worry if that doesn&rsquo;t mean much to you yet).</p>
<h2 id="random-forest">Random Forest</h2>
<p>Random Forests are one of the most powerful classification methods and I love them. They are incredibly powerful, accurate, and easy to use. Unfortunately, they are black-box algorithms (you don&rsquo;t know what&rsquo;s happening in them exactly in numerical terms) and they require observed outcomes. That&rsquo;s not a problem for us with this research project!</p>
<h3 id="population-status-classifier-2">Population Status Classifier</h3>
<p>Running our random for model for population statuses:</p>
<pre><code class="language-r">set.seed(42) # set seed because the process is random
H2_PS_RF &lt;- tuneRF(
  x = Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)], # variables which to use for clustering
  y = Sparrows_df$Population.Status, # correct cluster assignment
  strata = Sparrows_df$Population.Status, # stratified sampling
  doBest = TRUE, # run the best overall tree
  ntreeTry = 20000, # consider this number of trees
  improve = 0.0000001, # improvement if this is exceeded
  trace = FALSE, plot = FALSE
)
</code></pre>
<pre><code>## -0.08235294 1e-07
</code></pre>
<p>Works perfectly.</p>
<p>Random forests give us access to <em>confusion matrices</em> which tell us about classification accuracy:</p>
<pre><code class="language-r">H2_PS_RF[[&quot;confusion&quot;]]
</code></pre>
<pre><code>##            Introduced Native class.error
## Introduced        902     30  0.03218884
## Native             55     79  0.41044776
</code></pre>
<p>Evidently, we are good at predicting Introduced population status, but Native population status is almost as random as a coin toss.</p>
<p>Which variables give us the most information when establishing these groups?</p>
<pre><code class="language-r">varImpPlot(H2_PS_RF)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-30-1.png" width="1440" /></p>
<p>Well look who it is. <code>Weight</code> comes out as the most important variable once again!</p>
<h3 id="site-classifier-2">Site Classifier</h3>
<p>Let&rsquo;s run a random forest analysis for our site indices:</p>
<pre><code class="language-r">set.seed(42) # set seed because the process is random
H2_Index_RF &lt;- tuneRF(
  x = Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)], # variables which to use for clustering
  y = Sparrows_df$Index, # correct cluster assignment
  strata = Sparrows_df$Index, # stratified sampling
  doBest = TRUE, # run the best overall tree
  ntreeTry = 20000, # consider this number of trees
  improve = 0.0000001, # improvement if this is exceeded
  trace = FALSE, plot = FALSE
)
</code></pre>
<pre><code>## 0.01630435 1e-07 
## 0 1e-07
</code></pre>
<pre><code class="language-r">H2_Index_RF[[&quot;confusion&quot;]]
</code></pre>
<pre><code>##    AU  BE  FG FI LO MA NU RE  SA SI UK class.error
## AU 77   0   0  2  8  0  0  0   0  0  0  0.11494253
## BE  0 102   0  0  0  0  0  0   3  0  0  0.02857143
## FG  0   0 250  0  0  0  0  0   0  0  0  0.00000000
## FI  0   0   0 33  0 21  0  0   0  0 15  0.52173913
## LO  9   0   0  0 69  0  0  2   0  0  1  0.14814815
## MA  0   0   0 17  0 26  2  0   0  0 22  0.61194030
## NU  0   0   0  0  0  7 44  0   0  7  6  0.31250000
## RE  0   4   0  0  3  0  0 87   1  0  0  0.08421053
## SA  0   5   0  0  0  0  0  0 109  0  0  0.04385965
## SI  0   0   0  0  0  1  7  0   0 58  0  0.12121212
## UK  0   0   0 14  0 25  1  0   0  0 28  0.58823529
</code></pre>
<pre><code class="language-r">varImpPlot(H2_Index_RF)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-31-1.png" width="1440" /></p>
<p>Except for Manitoba and the UK (which are often mistaken for each other), morphology (and mostly <code>Weight</code>) explains station indices quite adequately.</p>
<h3 id="climate-classifier-2">Climate Classifier</h3>
<p>Lastly, we turn to our climate classifier again:</p>
<pre><code class="language-r">set.seed(42) # set seed because the process is random
H2_Climate_RF &lt;- tuneRF(
  x = Sparrows_df[, c(&quot;Weight&quot;, &quot;Height&quot;, &quot;Wing.Chord&quot;)], # variables which to use for clustering
  y = Sparrows_df$Climate, # correct cluster assignment
  strata = Sparrows_df$Climate, # stratified sampling
  doBest = TRUE, # run the best overall tree
  ntreeTry = 20000, # consider this number of trees
  improve = 0.0000001, # improvement if this is exceeded
  trace = FALSE, plot = FALSE
)
</code></pre>
<pre><code>## 0.05172414 1e-07 
## -0.02727273 1e-07
</code></pre>
<pre><code class="language-r">H2_Climate_RF[[&quot;confusion&quot;]]
</code></pre>
<pre><code>##              Coastal Continental Semi-Coastal class.error
## Coastal          797          16           33  0.05791962
## Continental       15         137            1  0.10457516
## Semi-Coastal      47           0           20  0.70149254
</code></pre>
<pre><code class="language-r">varImpPlot(H2_Climate_RF)
</code></pre>
<p><img src="5_Classifications---Order-from-Chaos_files/figure-html/unnamed-chunk-32-1.png" width="1440" /></p>
<p>Oof. We get semi-coastal habitats almost completely wrong. The other climate conditions are explained well through morphology, though.</p>
<h2 id="final-models">Final Models</h2>
<p>In our upcoming <a href="/courses/excursions-into-biostatistics/excursion-into-biostatistics/" target="_blank"> Model Selection and Validation</a> Session, we will look into how to compare and validate models. We now need to select some models we have created here today and want to carry forward to said session.</p>
<p>Personally, I am quite enamoured with our models <code>H2_PS_mclust</code> (k-means clustering of population status), <code>H2_PS_RF</code> (random forest of population status), and <code>H2_Index_RF</code> (random forest of site indices). Let&rsquo;s save these as a separate object ready to be loaded into our <code>R</code> environment in the coming session:</p>
<pre><code class="language-r">save(H2_PS_mclust, H2_PS_RF, H2_Index_RF, file = file.path(&quot;Data&quot;, &quot;H2_Models.RData&quot;))
</code></pre>
<h2 id="sessioninfo">SessionInfo</h2>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] MASS_7.3-58.2        car_3.1-1            carData_3.0-5        randomForest_4.7-1.1 rpart.plot_3.1.1     rpart_4.1.19         vegan_2.6-4          lattice_0.20-45      permute_0.9-7       
## [10] mclust_6.0.0         ggplot2_3.4.1       
## 
## loaded via a namespace (and not attached):
##  [1] styler_1.9.1      tidyselect_1.2.0  xfun_0.37         bslib_0.4.2       purrr_1.0.1       splines_4.2.3     colorspace_2.1-0  vctrs_0.5.2       generics_0.1.3    htmltools_0.5.4  
## [11] yaml_2.3.7        mgcv_1.8-42       utf8_1.2.3        rlang_1.0.6       R.oo_1.25.0       jquerylib_0.1.4   pillar_1.8.1      glue_1.6.2        withr_2.5.0       R.utils_2.12.2   
## [21] R.cache_0.16.0    lifecycle_1.0.3   munsell_0.5.0     blogdown_1.16     gtable_0.3.1      R.methodsS3_1.8.2 evaluate_0.20     labeling_0.4.2    knitr_1.42        fastmap_1.1.1    
## [31] parallel_4.2.3    fansi_1.0.4       highr_0.10        scales_1.2.1      cachem_1.0.7      jsonlite_1.8.4    abind_1.4-5       farver_2.1.1      digest_0.6.31     bookdown_0.33    
## [41] dplyr_1.1.0       grid_4.2.3        cli_3.6.0         tools_4.2.3       magrittr_2.0.3    sass_0.4.5        tibble_3.2.0      cluster_2.1.4     pkgconfig_2.0.3   Matrix_1.5-3     
## [51] rmarkdown_2.20    rstudioapi_0.14   R6_2.5.1          nlme_3.1-162      compiler_4.2.3
</code></pre>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/r/">R</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
</div>



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/" rel="next">Data Handling and Data Assumptions</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/excursions-into-biostatistics/regressions-correlations-for-the-advanced/" rel="prev">Regressions</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 2020-02-27</p>

          





          


          


  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/courses/excursions-into-biostatistics/data-handling-and-data-assumptions/">Data Handling and Data Assumptions</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/excursion-into-biostatistics/">Model Selection</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/regressions-correlations-for-the-advanced/">Regressions</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/research-project/">Research Project</a></li>
      
      <li><a href="/courses/excursions-into-biostatistics/research-project/">Research Project</a></li>
      
    </ul>
  </div>
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
     2024
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
