<!DOCTYPE html><html lang="en-gb" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Erik Kusch">

  
  
  
    
  
  <meta name="description" content="Answers and solutions to the exercises belonging to chapter 3 in [Satistical Rethinking 2](https://xcelab.net/rm/statistical-rethinking/) by Richard McElreath.">

  
  <link rel="alternate" hreflang="en-gb" href="https://www.erikkusch.com/courses/rethinking/chapter-03/">

  


  
  
  
  <meta name="theme-color" content="#858383">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186216138-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186216138-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.erikkusch.com/courses/rethinking/chapter-03/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ErikKusch">
  <meta property="twitter:creator" content="@ErikKusch">
  
  <meta property="og:site_name" content="Erik Kusch">
  <meta property="og:url" content="https://www.erikkusch.com/courses/rethinking/chapter-03/">
  <meta property="og:title" content="Chapter 03 | Erik Kusch">
  <meta property="og:description" content="Answers and solutions to the exercises belonging to chapter 3 in [Satistical Rethinking 2](https://xcelab.net/rm/statistical-rethinking/) by Richard McElreath."><meta property="og:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg">
  <meta property="twitter:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg"><meta property="og:locale" content="en-gb">
  
    
      <meta property="article:published_time" content="2021-01-07T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-01-07T08:00:00&#43;01:00">
  

  



  


  


  





  <title>Chapter 03 | Erik Kusch</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses & Workshops</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/krigr/"><span>KrigR - State-of-the-Art Climate Data within R</span></a>
            
              <a class="dropdown-item" href="/courses/gbif/"><span>Accessing and Referencing GBIF Data for Research</span></a>
            
              <a class="dropdown-item" href="/courses/rethinking/"><span>Statistical Rethinking - Introduction to Bayesian Statistics</span></a>
            
              <a class="dropdown-item" href="/courses/bayes-nets/"><span>Bayesian Networks - Causality through Bayesian Approaches</span></a>
            
              <a class="dropdown-item" href="/courses/biostat101/"><span>Biostats 101 - An Introduction to Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/excursions-into-biostatistics/"><span>Biostats 301 - Excursions into Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/bftp-biome-detection/"><span>BFTP - First Steps in Macroecology in R</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/media/CV_ErikKusch.html" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/rethinking/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/rethinking/chapter-02/">Seminars</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/rethinking/chapter-02/">Chapter 01 &amp; 02</a>
      </li>
      
      <li class="active">
        <a href="/courses/rethinking/chapter-03/">Chapter 03</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-04/">Chapter 04</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-04b/">Chapter 04 (Extra Material)</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-05/">Chapter 05</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-06/">Chapter 06</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-07/">Chapter 07</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-08/">Chapter 08</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-09/">Chapter 09</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-11/">Chapter 10 &amp; 11</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-12/">Chapter 12</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-13/">Chapter 13</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-14/">Chapter 14</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-15/">Chapter 15</a>
      </li>
      
      <li >
        <a href="/courses/rethinking/chapter-16/">Chapter 16</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#material">Material</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#easy-exercises">Easy Exercises</a></li>
    <li><a href="#practice-e1">Practice E1</a>
      <ul>
        <li><a href="#practice-e2">Practice E2</a></li>
        <li><a href="#practice-e3">Practice E3</a></li>
        <li><a href="#practice-e4">Practice E4</a></li>
        <li><a href="#practice-e5">Practice E5</a></li>
        <li><a href="#practice-e6">Practice E6</a></li>
        <li><a href="#practice-e7">Practice E7</a></li>
      </ul>
    </li>
    <li><a href="#medium-exercises">Medium Exercises</a>
      <ul>
        <li><a href="#practice-m1">Practice M1</a></li>
        <li><a href="#practice-m2">Practice M2</a></li>
        <li><a href="#practice-m3">Practice M3</a></li>
        <li><a href="#practice-m4">Practice M4</a></li>
        <li><a href="#practice-m5">Practice M5</a></li>
        <li><a href="#practice-m6">Practice M6</a></li>
      </ul>
    </li>
    <li><a href="#hard-exercises">Hard Exercises</a>
      <ul>
        <li><a href="#practice-h1">Practice H1</a></li>
        <li><a href="#practice-h2">Practice H2</a></li>
        <li><a href="#practice-h3">Practice H3</a></li>
        <li><a href="#practice-h4">Practice H4</a></li>
        <li><a href="#practice-h5">Practice H5</a></li>
      </ul>
    </li>
    <li><a href="#session-info">Session Info</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Chapter 03</h1>

          <div class="article-style">
            <h1 id="sampling-the-imaginary">Sampling the Imaginary</h1>
<h2 id="material">Material</h2>
<ul>
<li>
<a href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/courses/rethinking/2_18-12-2020_SUMMARY_-Basics-of-Bayesian-Inference-and-Counting.html" target="_blank" rel="noopener">Slides Chapter 3</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>These are answers and solutions to the exercises at the end of chapter 3 in 
<a href="https://xcelab.net/rm/statistical-rethinking/" target="_blank" rel="noopener">Satistical Rethinking 2</a> by Richard McElreath. I have created these notes as a part of my ongoing involvement in the 
<a href="/project/aubayes/">AU Bayes Study Group</a>. Much of my inspiration for these solutions, where necessary, has been obtained from 
<a href="https://jmgirard.com/statistical-rethinking-ch3/" target="_blank" rel="noopener">Jeffrey Girard</a>.</p>
<p>Loading <code>rethinking</code> package for visualisations:</p>
<pre><code class="language-r">rm(list = ls())
library(rethinking)
</code></pre>
<h2 id="easy-exercises">Easy Exercises</h2>
<p>These problems use the samples from the posterior distribution for the globe tossing example. This code will give you a specific set of samples, so that you can check your answers exactly. Use the values in <code>samples</code> to answer the questions that follow.</p>
<pre><code class="language-r">p_grid &lt;- seq(from = 0, to = 1, length.out = 1000)
prior &lt;- rep(1, 1000)
likelihood &lt;- dbinom(6, size = 9, prob = p_grid)
posterior &lt;- likelihood * prior
posterior &lt;- posterior / sum(posterior)
set.seed(100)
samples &lt;- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)
hist(samples)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-2-1.png" width="1440" /></p>
<h2 id="practice-e1">Practice E1</h2>
<p><strong>Question:</strong> How much posterior probability lies below $p=0.2$?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r"># how the book did it
sum(samples &lt; .2) / length(samples)
</code></pre>
<pre><code>## [1] 4e-04
</code></pre>
<pre><code class="language-r"># easier way
mean(samples &lt; 0.2)
</code></pre>
<pre><code>## [1] 4e-04
</code></pre>
<h3 id="practice-e2">Practice E2</h3>
<p><strong>Question:</strong> How much posterior probability lies above $p=0.8$?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">mean(samples &gt; 0.8)
</code></pre>
<pre><code>## [1] 0.1116
</code></pre>
<h3 id="practice-e3">Practice E3</h3>
<p><strong>Question:</strong> How much posterior probability lies between $p=0.2$ and $p=0.8$?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">mean(samples &gt; 0.2 &amp; samples &lt; 0.8)
</code></pre>
<pre><code>## [1] 0.888
</code></pre>
<h3 id="practice-e4">Practice E4</h3>
<p><strong>Question:</strong> 20% of the posterior probability lies below which value of $p$?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">quantile(samples, 0.2)
</code></pre>
<pre><code>##       20% 
## 0.5185185
</code></pre>
<h3 id="practice-e5">Practice E5</h3>
<p><strong>Question:</strong> 20% of the posterior probability lies above which value of $p$?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">quantile(samples, 0.8)
</code></pre>
<pre><code>##       80% 
## 0.7557558
</code></pre>
<h3 id="practice-e6">Practice E6</h3>
<p><strong>Question:</strong> Which values of $p$ contain the narrowest interval equal to 66% of the posterior probability?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">HPDI(samples, prob = 0.66)
</code></pre>
<pre><code>##     |0.66     0.66| 
## 0.5085085 0.7737738
</code></pre>
<h3 id="practice-e7">Practice E7</h3>
<p><strong>Question:</strong> Which values of p contain 66% of the posterior probability, assuming equal posterior probability both below and above the interval?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">PI(samples, prob = 0.66)
</code></pre>
<pre><code>##       17%       83% 
## 0.5025025 0.7697698
</code></pre>
<h2 id="medium-exercises">Medium Exercises</h2>
<h3 id="practice-m1">Practice M1</h3>
<p><strong>Question:</strong> Suppose the globe tossing data had turned out to be 8 water in 15 tosses. Construct the posterior distribution, using grid approximation. Use the same flat prior as before.</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">p_grid &lt;- seq(from = 0, to = 1, length.out = 1000)
prior &lt;- rep(1, 1000)
likelihood &lt;- dbinom(8, size = 15, prob = p_grid)
posterior &lt;- likelihood * prior
posterior &lt;- posterior / sum(posterior)
plot(p_grid, posterior, type = &quot;l&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-10-1.png" width="1440" /></p>
<pre><code class="language-r">p_grid[which.max(posterior)]
</code></pre>
<pre><code>## [1] 0.5335335
</code></pre>
<h3 id="practice-m2">Practice M2</h3>
<p><strong>Question:</strong> Draw 10,000 samples from the grid approximation from above. Then use the samples to calculate the 90% HPDI for $p$.</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">set.seed(42)
samples &lt;- sample(p_grid, prob = posterior, replace = TRUE, size = 1e+4)
hist(samples)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-11-1.png" width="1440" /></p>
<pre><code class="language-r">HPDI(samples, prob = .9)
</code></pre>
<pre><code>##      |0.9      0.9| 
## 0.3393393 0.7267267
</code></pre>
<pre><code class="language-r">mean(samples)
</code></pre>
<pre><code>## [1] 0.5295147
</code></pre>
<pre><code class="language-r">median(samples)
</code></pre>
<pre><code>## [1] 0.5305305
</code></pre>
<h3 id="practice-m3">Practice M3</h3>
<p><strong>Question:</strong> Construct a posterior predictive check for this model and data. This means simulate the distribution of samples, averaging over the posterior uncertainty in $p$. What is the probability of observing 8 water in 15 tosses?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n &lt;- 15
set.seed(42)
dumdata &lt;- rbinom(10000, size = n, prob = samples)
simplehist(dumdata)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-12-1.png" width="1440" /></p>
<pre><code class="language-r">mean(dumdata == 8)
</code></pre>
<pre><code>## [1] 0.1419
</code></pre>
<h3 id="practice-m4">Practice M4</h3>
<p><strong>Question:</strong> Using the posterior distribution constructed from the new (8/15) data, now calculate the probability of observing 6 water in 9 tosses.</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">likelihood_6of9 &lt;- dbinom(6, size = 9, prob = p_grid)
prior_6of9 &lt;- posterior
(p_6of9 &lt;- sum(likelihood_6of9 * prior_6of9))
</code></pre>
<pre><code>## [1] 0.1763898
</code></pre>
<pre><code class="language-r">## Alternatively, we can generate the data using the same seed as above:
set.seed(100)
dumdata_6of9 &lt;- rbinom(10000, size = 9, prob = samples)
simplehist(dumdata_6of9)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-13-1.png" width="1440" /></p>
<pre><code class="language-r">mean(dumdata_6of9 == 6)
</code></pre>
<pre><code>## [1] 0.1765
</code></pre>
<h3 id="practice-m5">Practice M5</h3>
<p><strong>Question:</strong> Start over at 3M1, but now use a prior that is zero below $p=0.5$ and a constant above $p=0.5$. This corresponds to prior information that a majority of the Earth’s surface is water. Repeat each problem above and compare the inferences. What difference does the better prior make? If it helps, compare inferences (using both priors) to the true value $p=0.7$.</p>
<h4 id="part-a">Part A</h4>
<p><strong>Question:</strong> Construct the posterior distribution, using grid approximation.</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">p_grid &lt;- seq(from = 0, to = 1, length.out = 1000)
prior &lt;- ifelse(p_grid &lt; 0.5, 0, 0.5)
likelihood &lt;- dbinom(8, size = 15, prob = p_grid)
posterior &lt;- likelihood * prior
posterior &lt;- posterior / sum(posterior)
plot(p_grid, posterior, type = &quot;l&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-14-1.png" width="1440" /></p>
<pre><code class="language-r">p_grid[which.max(posterior)]
</code></pre>
<pre><code>## [1] 0.5335335
</code></pre>
<h4 id="part-b">Part B</h4>
<p><strong>Question:</strong> Draw 10,000 samples from the grid approximation from above. Then use the samples to calculate the 90% HPDI for $p$</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">set.seed(42)
samples &lt;- sample(p_grid, prob = posterior, replace = TRUE, size = 1e+4)
hist(samples)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-15-1.png" width="1440" /></p>
<pre><code class="language-r">HPDI(samples, prob = .9)
</code></pre>
<pre><code>##      |0.9      0.9| 
## 0.5005005 0.7117117
</code></pre>
<pre><code class="language-r">mean(samples)
</code></pre>
<pre><code>## [1] 0.6067921
</code></pre>
<pre><code class="language-r">median(samples)
</code></pre>
<pre><code>## [1] 0.5945946
</code></pre>
<h4 id="part-c">Part C</h4>
<p><strong>Question:</strong> What is the probability of observing 8 water in 15 tosses?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n &lt;- 15
set.seed(42)
dumdata &lt;- rbinom(10000, size = n, prob = samples)
simplehist(dumdata)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-16-1.png" width="1440" /></p>
<pre><code class="language-r">mean(dumdata == 8)
</code></pre>
<pre><code>## [1] 0.1516
</code></pre>
<pre><code class="language-r">table(dumdata) / 1e+4
</code></pre>
<pre><code>## dumdata
##      1      2      3      4      5      6      7      8      9     10     11     12     13     14     15 
## 0.0002 0.0004 0.0038 0.0125 0.0329 0.0671 0.1188 0.1516 0.1734 0.1712 0.1276 0.0823 0.0398 0.0157 0.0027
</code></pre>
<h4 id="part-d">Part D</h4>
<p><strong>Question:</strong> Using the posterior distribution constructed from the new (8/15) data, now calculate the probability of observing 6 water in 9 tosses.</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">likelihood_6of9 &lt;- dbinom(6, size = 9, prob = p_grid)
prior_6of9 &lt;- posterior
(p_6of9 &lt;- sum(likelihood_6of9 * prior_6of9))
</code></pre>
<pre><code>## [1] 0.2323071
</code></pre>
<pre><code class="language-r">## Alternatively, we can generate the data using the same seed as above:
set.seed(100)
dumdata_6of9 &lt;- rbinom(10000, size = 9, prob = samples)
simplehist(dumdata_6of9)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-17-1.png" width="1440" /></p>
<pre><code class="language-r">mean(dumdata_6of9 == 6)
</code></pre>
<pre><code>## [1] 0.2321
</code></pre>
<h3 id="practice-m6">Practice M6</h3>
<p><strong>Question:</strong> Suppose you want to estimate the Earth’s proportion of water very precisely. Specifically, you want the 99% percentile interval of the posterior distribution of $p$ to be only 0.05 wide. This means the distance between the upper and lower bound of the interval should be 0.05. How many times will you have to toss the globe to do this?</p>
<p><strong>Answer:</strong> Solution taken from 
<a href="https://github.com/rmcelreath/statrethinking_winter2019/blob/master/homework/week01_solutions.pdf" target="_blank" rel="noopener">Richard McElreath</a> and altered by myself.</p>
<pre><code class="language-r">f &lt;- function(N) {
  p_true &lt;- 0.7
  W &lt;- rbinom(1, size = N, prob = p_true)
  prob_grid &lt;- seq(0, 1, length.out = 1000)
  prior &lt;- rep(1, 1000)
  prob_data &lt;- dbinom(W, size = N, prob = prob_grid)
  posterior &lt;- prob_data * prior
  posterior &lt;- posterior / sum(posterior)
  samples &lt;- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)
  PI99 &lt;- PI(samples, .99)
  as.numeric(PI99[2] - PI99[1])
}
Nlist &lt;- c(20, 50, 100, 200, 500, 1000, 2000)
Nlist &lt;- rep(Nlist, each = 100)
width &lt;- sapply(Nlist, f)
plot(Nlist, width)
abline(h = 0.05, col = &quot;red&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-18-1.png" width="1440" /></p>
<h2 id="hard-exercises">Hard Exercises</h2>
<pre><code class="language-r">data(homeworkch3)
</code></pre>
<h3 id="practice-h1">Practice H1</h3>
<p><strong>Question:</strong> Using grid approximation, compute the posterior distribution for the probability of a birth being a boy. Assume a uniform prior probability. Which parameter value maximizes the posterior probability?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n_boys &lt;- sum(c(birth1, birth2))
n_ttl &lt;- length(birth1) + length(birth2)
n_pgrid &lt;- 1000
p_grid &lt;- seq(0, 1, length.out = n_pgrid)
prior &lt;- rep(1, n_pgrid)
likelihood &lt;- dbinom(n_boys, size = n_ttl, prob = p_grid)
posterior &lt;- likelihood * prior
posterior &lt;- posterior / sum(posterior)
plot(p_grid, posterior, type = &quot;l&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-20-1.png" width="1440" /></p>
<pre><code class="language-r">p_grid[which.max(posterior)]
</code></pre>
<pre><code>## [1] 0.5545546
</code></pre>
<h3 id="practice-h2">Practice H2</h3>
<p><strong>Question:</strong> Using the $sample()$ function, draw 10000 random parameter values from the posterior distribution you calculated above. Use these samples to estimate the 50%, 89% and 97% highest posterior density intervals.</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n_ptrials &lt;- 1e4
p_samples &lt;- sample(p_grid, size = n_ptrials, prob = posterior, replace = TRUE)
(hpi_50 &lt;- HPDI(p_samples, .5))
</code></pre>
<pre><code>##      |0.5      0.5| 
## 0.5265265 0.5735736
</code></pre>
<pre><code class="language-r">(hpi_89 &lt;- HPDI(p_samples, .89))
</code></pre>
<pre><code>##     |0.89     0.89| 
## 0.4964965 0.6076076
</code></pre>
<pre><code class="language-r">(hpi_97 &lt;- HPDI(p_samples, .97))
</code></pre>
<pre><code>##     |0.97     0.97| 
## 0.4784785 0.6276276
</code></pre>
<pre><code class="language-r">for (w in c(.5, .89, .97)) {
  hpi &lt;- HPDI(p_samples, w)
  print(sprintf(&quot;HPDI %d%% [%f, %f]&quot;, w * 100, hpi[1], hpi[2]))
}
</code></pre>
<pre><code>## [1] &quot;HPDI 50% [0.526527, 0.573574]&quot;
## [1] &quot;HPDI 89% [0.496496, 0.607608]&quot;
## [1] &quot;HPDI 97% [0.478478, 0.627628]&quot;
</code></pre>
<pre><code class="language-r">mean(p_samples)
</code></pre>
<pre><code>## [1] 0.5545528
</code></pre>
<pre><code class="language-r">median(p_samples)
</code></pre>
<pre><code>## [1] 0.5545546
</code></pre>
<h3 id="practice-h3">Practice H3</h3>
<p><strong>Question:</strong> Use <code>rbinom()</code> to simulate 10000 replicates of 200 births. You should end up with 10000 numbers, each one a count of boys out of 200 births. Compare the distribution of predicted numbers of boys to the actual count in the data (111 boys out of 200 births). There are many good ways to visualize the simulations, but the <code>dens()</code> command (part of the <code>rethinking</code> package) is probably the easiest way in this case. Does it look like the model fits the data well? That is, does the distribution of predictions include the actual observation as a central, likely outcome?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n_btrials &lt;- 1e4 # birth observations
set.seed(42)
b_sample &lt;- rbinom(n_btrials, size = n_ttl, prob = p_samples)
simplehist(b_sample)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-22-1.png" width="1440" /></p>
<pre><code class="language-r">mean(b_sample)
</code></pre>
<pre><code>## [1] 110.9792
</code></pre>
<pre><code class="language-r">median(b_sample)
</code></pre>
<pre><code>## [1] 111
</code></pre>
<pre><code class="language-r">dens(b_sample)
abline(v = n_boys, col = &quot;red&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-22-2.png" width="1440" /></p>
<h3 id="practice-h4">Practice H4</h3>
<p><strong>Question:</strong> Now compare 10000 counts of boys from 100 simulated first-borns only to the number of boys in the first births, <code>birth1</code>. How does the model look in this light?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n_boys_b1 &lt;- sum(birth1)
n_ttl_b1 &lt;- length(birth1)
n_btrials &lt;- 1e4 # birth observations
likelihood &lt;- dbinom(sum(birth1), size = length(birth1), prob = p_grid)
posterior &lt;- likelihood * prior
posterior &lt;- posterior / sum(posterior)
samples &lt;- sample(p_grid, prob = posterior, size = 1e4, replace = TRUE)
set.seed(42)
b_sample &lt;- rbinom(n_btrials, size = n_ttl_b1, prob = samples)
simplehist(b_sample)
abline(v = n_boys_b1, col = &quot;red&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-23-1.png" width="1440" /></p>
<pre><code class="language-r">mean(b_sample)
</code></pre>
<pre><code>## [1] 51.0102
</code></pre>
<pre><code class="language-r">median(b_sample)
</code></pre>
<pre><code>## [1] 51
</code></pre>
<pre><code class="language-r">dens(b_sample)
abline(v = n_boys_b1, col = &quot;red&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-23-2.png" width="1440" /></p>
<h3 id="practice-h5">Practice H5</h3>
<p><strong>Question:</strong> The model assumes that sex of first and second births are independent. To check this assumption, focus now on second births that followed female first-borns. Compare 10,000 simulated counts of boys to only those second births that followed girls. To do this correctly, you need to count the number of first-borns who were girls and simulate that many births, 10,000 times. Compare the counts of boys in your simulations to the actual observed count of boys following girls. How does the model look in this light? Any guesses what is going on in these data?</p>
<p><strong>Answer:</strong></p>
<pre><code class="language-r">n_ttl_g1 &lt;- sum(birth1 == 0)
n_ttl_g1b2 &lt;- sum(birth2[birth1 == 0])
print(sprintf(&quot;there were %d boys born after first girl. There were ttl %d cases&quot;, n_ttl_g1b2, n_ttl_g1))
</code></pre>
<pre><code>## [1] &quot;there were 39 boys born after first girl. There were ttl 49 cases&quot;
</code></pre>
<pre><code class="language-r">n_btrials &lt;- 1e4 # birth observations
b_sample &lt;- rbinom(n_btrials, size = n_ttl_g1, prob = p_samples)
mean(b_sample)
</code></pre>
<pre><code>## [1] 27.1431
</code></pre>
<pre><code class="language-r">median(b_sample)
</code></pre>
<pre><code>## [1] 27
</code></pre>
<pre><code class="language-r">simplehist(b_sample)
abline(v = n_ttl_g1b2, col = &quot;red&quot;)
</code></pre>
<p><img src="2021-01-08-statistical-rethinking-chapter-03_files/figure-html/unnamed-chunk-24-1.png" width="1440" /></p>
<p>The model underestimates number of boys for the second child after the first girl. Gender of the second child is not independent from the first one.</p>
<h2 id="session-info">Session Info</h2>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.0.5 (2021-03-31)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19043)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United Kingdom.1252    LC_MONETARY=English_United Kingdom.1252 LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.1252    
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] rethinking_2.13      rstan_2.21.2         ggplot2_3.3.3        StanHeaders_2.21.0-7
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.7         mvtnorm_1.1-1      lattice_0.20-41    prettyunits_1.1.1  ps_1.6.0           assertthat_0.2.1   digest_0.6.27      utf8_1.2.1         V8_3.4.1           R6_2.5.0          
## [11] backports_1.2.1    stats4_4.0.5       evaluate_0.14      coda_0.19-4        highr_0.9          blogdown_1.3       pillar_1.6.0       rlang_0.4.11       curl_4.3.2         callr_3.7.0       
## [21] jquerylib_0.1.4    R.utils_2.10.1     R.oo_1.24.0        rmarkdown_2.7      styler_1.4.1       stringr_1.4.0      loo_2.4.1          munsell_0.5.0      compiler_4.0.5     xfun_0.22         
## [31] pkgconfig_2.0.3    pkgbuild_1.2.0     shape_1.4.5        htmltools_0.5.1.1  tidyselect_1.1.0   tibble_3.1.1       gridExtra_2.3      bookdown_0.22      codetools_0.2-18   matrixStats_0.61.0
## [41] fansi_0.4.2        crayon_1.4.1       dplyr_1.0.5        withr_2.4.2        MASS_7.3-53.1      R.methodsS3_1.8.1  grid_4.0.5         jsonlite_1.7.2     gtable_0.3.0       lifecycle_1.0.0   
## [51] DBI_1.1.1          magrittr_2.0.1     scales_1.1.1       RcppParallel_5.1.2 cli_3.0.0          stringi_1.5.3      bslib_0.2.4        ellipsis_0.3.2     generics_0.1.0     vctrs_0.3.7       
## [61] rematch2_2.1.2     tools_4.0.5        R.cache_0.14.0     glue_1.4.2         purrr_0.3.4        processx_3.5.1     yaml_2.2.1         inline_0.3.17      colorspace_2.0-0   knitr_1.33        
## [71] sass_0.3.1
</code></pre>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/tag/bayes/">Bayes</a>
  
  <a class="badge badge-light" href="/tag/bayesian-statistics/">Bayesian Statistics</a>
  
  <a class="badge badge-light" href="/tag/au-bayes-study-group/">AU Bayes Study Group</a>
  
</div>



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/rethinking/chapter-02/" rel="next">Chapter 01 &amp; 02</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/rethinking/chapter-04/" rel="prev">Chapter 04</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 2021-01-07</p>

          





          


          


  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/courses/rethinking/chapter-16/">Chapter 16</a></li>
      
      <li><a href="/courses/rethinking/chapter-15/">Chapter 15</a></li>
      
      <li><a href="/courses/rethinking/chapter-14/">Chapter 14</a></li>
      
      <li><a href="/courses/rethinking/chapter-13/">Chapter 13</a></li>
      
      <li><a href="/courses/rethinking/chapter-12/">Chapter 12</a></li>
      
    </ul>
  </div>
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    © 2024
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
