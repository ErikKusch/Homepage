<!DOCTYPE html><html lang="en-gb" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Erik Kusch">

  
  
  
    
  
  <meta name="description" content="KrigR is currently undergoing development. As a result, this part of the workshop has become deprecated. Please refer to the setup quick guide portions of this material as these are up-to-date.">

  
  <link rel="alternate" hreflang="en-gb" href="https://www.erikkusch.com/courses/krigr/projections/">

  


  
  
  
  <meta name="theme-color" content="#858383">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186216138-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186216138-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.erikkusch.com/courses/krigr/projections/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ErikKusch">
  <meta property="twitter:creator" content="@ErikKusch">
  
  <meta property="og:site_name" content="Erik Kusch">
  <meta property="og:url" content="https://www.erikkusch.com/courses/krigr/projections/">
  <meta property="og:title" content="Projection Downscaling | Erik Kusch">
  <meta property="og:description" content="KrigR is currently undergoing development. As a result, this part of the workshop has become deprecated. Please refer to the setup quick guide portions of this material as these are up-to-date."><meta property="og:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg">
  <meta property="twitter:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg"><meta property="og:locale" content="en-gb">
  
    
      <meta property="article:published_time" content="2022-05-26T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-05-26T20:00:00&#43;01:00">
  

  



  


  


  





  <title>Projection Downscaling | Erik Kusch</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses & Workshops</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/krigr/"><span>KrigR - State-of-the-Art Climate Data within R</span></a>
            
              <a class="dropdown-item" href="/courses/gbif/"><span>Accessing and Referencing GBIF Data for Research</span></a>
            
              <a class="dropdown-item" href="/courses/rethinking/"><span>Statistical Rethinking - Introduction to Bayesian Statistics</span></a>
            
              <a class="dropdown-item" href="/courses/bayes-nets/"><span>Bayesian Networks - Causality through Bayesian Approaches</span></a>
            
              <a class="dropdown-item" href="/courses/biostat101/"><span>Biostats 101 - An Introduction to Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/excursions-into-biostatistics/"><span>Biostats 301 - Excursions into Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/bftp-biome-detection/"><span>BFTP - First Steps in Macroecology in R</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/media/CV_ErikKusch.html" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/krigr/">Introduction</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/krigr/">Motivation &amp; Workshop</a>
      </li>
      
      <li >
        <a href="/courses/krigr/background/">The Theory Behind KrigR</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/krigr/setup/">Quick Start</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/krigr/setup/">Setting up KrigR</a>
      </li>
      
      <li >
        <a href="/courses/krigr/quickstart/">Quick Guide</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/krigr/prep/">Workshop</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/krigr/prep/">Preparing the Workshop</a>
      </li>
      
      <li >
        <a href="/courses/krigr/download/">Downloading &amp; Processing</a>
      </li>
      
      <li >
        <a href="/courses/krigr/kriging/">Statistical Downscaling</a>
      </li>
      
      <li >
        <a href="/courses/krigr/bioclim/">Bioclimatic Variables</a>
      </li>
      
      <li >
        <a href="/courses/krigr/third-party/">Third-Party Data</a>
      </li>
      
      <li class="active">
        <a href="/courses/krigr/projections/">Projection Downscaling</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#krigr-process-for-projections"><code>KrigR</code> Process for Projections</a>
      <ul>
        <li><a href="#obtaining-era5-land-data">Obtaining ERA5(-Land) Data</a></li>
        <li><a href="#obtaining-projection-data">Obtaining Projection Data</a></li>
        <li><a href="#establishing-kriged-products">Establishing Kriged Products</a></li>
        <li><a href="#putting-it-all-together">Putting It All Together</a></li>
      </ul>
    </li>
    <li><a href="#considerations-for-projection-kriging">Considerations for Projection Kriging</a>
      <ul>
        <li><a href="#reliability">Reliability</a></li>
        <li><a href="#uncertainty">Uncertainty</a></li>
      </ul>
    </li>
    <li><a href="#session-info">Session Info</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Projection Downscaling</h1>

          <div class="article-style">
            <p><div class="alert alert-danger">
  <div>
    <strong><code>KrigR</code> is currently undergoing development. As a result, this part of the workshop has become deprecated. Please refer to the <a href="/courses/krigr/setup/">setup</a> <a href="/courses/krigr/quickstart/">quick guide</a> portions of this material as these are up-to-date. </strong>
  </div>
</div>
</p>
<div class="alert alert-danger">
  <div>
    This part of the workshop is dependant on set-up and preparation done previously <a href="/courses/krigr/prep/">here</a>.
  </div>
</div>
<p>First, we load <code>KrigR</code>:</p>
<pre><code class="language-r">library(KrigR)
</code></pre>
<p>I expect that you will often be interested not just in past and current climatic conditions, but also in future projections of climate data at high spatial resolutions.</p>
<div class="alert alert-info">
  <div>
    The <code>KrigR</code> workflow can be used to establish high-resolution, bias-corrected climate projection products.
  </div>
</div>
<p>This time, we run our exercise for all of Germany because of its size and topographical variety.</p>
<pre><code class="language-r">Shape_shp &lt;- ne_countries(country = &quot;Germany&quot;)
</code></pre>
<h2 id="krigr-process-for-projections"><code>KrigR</code> Process for Projections</h2>
<p>We published the the <code>KrigR</code> workflow for downscaled climate projections in 
<a href="https://iopscience.iop.org/article/10.1088/1748-9326/ac48b3" target="_blank" rel="noopener">this publication (Section 3.5)</a> and I will walk you through the contents thereof here.</p>
<p>To achieve downscaled projection products we require three data products:</p>
<ol>
<li>Historical climate data from ERA5(-Land)</li>
<li>Historical climate data from projection source</li>
<li>Future climate data from projection source</li>
</ol>
<p>Subsequently, the data products are downscaled to the desired spatial resolution using <code>krigR()</code>. Finally, the difference between the downscaled projection-sourced data are added to the historical baseline obtained from (downscaled) ERA5(-Land) data. This achieves bias correction.</p>
<h3 id="obtaining-era5-land-data">Obtaining ERA5(-Land) Data</h3>
<p>Now, let&rsquo;s obtain the historical baseline from ERA5-Land for the same time-period as our CMIP6 historical data.</p>
<details>
  <summary>Click here for file if download takes too long:</summary>
    Download 
<a href="https://github.com/ErikKusch/Homepage/raw/master/content/courses/krigr/Data/Germany_Hist_ERA.nc">Germany_Hist_ERA.nc</a> and place it into your data directory.
</details> 
<pre><code class="language-r">if(!file.exists(file.path(Dir.Data, &quot;Germany_Hist_ERA.nc&quot;))){
  Hist_ERA_ras &lt;- download_ERA(Variable = &quot;2m_temperature&quot;,
                               DateStart = &quot;1981-01-01&quot;,
                               DateStop = &quot;1999-12-31&quot;,
                               TResolution = &quot;month&quot;,
                               TStep = 1,
                               Extent = Shape_shp,
                               Dir = Dir.Data,
                               FileName = &quot;Germany_Hist_ERA&quot;, 
                               API_Key = API_Key,
                               API_User = API_User,
                               SingularDL = TRUE)
  Index &lt;- rep(1:12, length = nlayers(Hist_ERA_ras))
  Hist_ERA_ras &lt;- stackApply(Hist_ERA_ras, indices = Index, fun = mean)
  writeRaster(Hist_ERA_ras, filename = file.path(Dir.Data, &quot;Germany_Hist_ERA&quot;), format = &quot;CDF&quot;)
}
Hist_ERA_ras &lt;- mean(stack(file.path(Dir.Data, &quot;Germany_Hist_ERA.nc&quot;)))
</code></pre>
<h3 id="obtaining-projection-data">Obtaining Projection Data</h3>
<p>Here, we use CMIP6 projection data manually sourced from the 
<a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/projections-cmip6?tab=overview" target="_blank" rel="noopener">ECMWF CDS distribution</a>.</p>
<div class="alert alert-">
  <div>
    Our <a href="/courses/krigr/outlook/">development goals</a> include development of <code>download_ERA()</code> to work with other ECWMF CDS data sets aside from ERA5(-Land). This includes this CMIP6 data set.
  </div>
</div>
<h4 id="historical-baseline">Historical Baseline</h4>
<details>
  <summary>Click here for file:</summary>
    Download 
<a href="https://github.com/ErikKusch/Homepage/raw/master/content/courses/krigr/Data/historical_tas_1981-2000.nc">historical_tas_1981-2000.nc</a> and place it into your data directory.
</details> 
<pre><code class="language-r">train_HIST &lt;- mean(stack(file.path(Dir.Data, &quot;historical_tas_1981-2000.nc&quot;)))
train_HIST &lt;- crop(train_HIST,extent(Hist_ERA_ras))
train_mask &lt;- KrigR::mask_Shape(train_HIST, Shape_shp)
train_HIST &lt;- mask(train_HIST, train_mask)
</code></pre>
<h4 id="future-projection">Future Projection</h4>
<details>
  <summary>Click here for file:</summary>
    Download 
<a href="https://github.com/ErikKusch/Homepage/raw/master/content/courses/krigr/Data/ssp585_tas_2041-2060.nc">ssp585_tas_2041-2060.nc</a> and place it into your data directory.
</details> 
<pre><code class="language-r">train_SSP &lt;- mean(stack(file.path(Dir.Data, &quot;ssp585_tas_2041-2060.nc&quot;)))
train_SSP &lt;- crop(train_SSP,extent(Hist_ERA_ras))
train_mask &lt;- KrigR::mask_Shape(train_SSP, Shape_shp)
train_SSP &lt;- mask(train_SSP, train_mask)
</code></pre>
<h4 id="visualisation-of-cmip6-data">Visualisation of CMIP6 Data</h4>
<pre><code class="language-r">Plot_Raw(stack(train_HIST, train_SSP), 
         Shp = Shape_shp,
         Dates = c(&quot;Historic CMIP6&quot;, &quot;Future CMIP6&quot;))
</code></pre>
<p><img src="krigr-projections_files/figure-html/unnamed-chunk-5-1.png" width="1440" /></p>
<p>Already, we can see that quite a bit of warming is projected to happen all across Germany. However, we want to know about this at higher spatial resolutions. That&rsquo;s where <code>KrigR</code> comes in.</p>
<h3 id="establishing-kriged-products">Establishing Kriged Products</h3>
<p>For the first time in this workshop material, we will push our spatial resolution to the finest scale supported by our default GMTED 2010 DEM covariate data: 0.008333 / ~1km.</p>
<div class="alert alert-warning">
  <div>
    These operations take quite some time - grab a tea or coffee, go for a walk, or stretch a bit.
  </div>
</div>
<p>The downscaling calls should be familiar by now so I will forego explaining them. In case, the following code snippets do not make sense to you, please consult the portion of this workshop concerned with 
<a href="/courses/krigr/kriging/">statistical downscaling</a>.</p>
<h4 id="historical-cmip6">Historical CMIP6</h4>
<pre><code class="language-r">## Covariate Data
GMTED_DE &lt;- download_DEM(
  Train_ras = train_HIST,
  Target_res = 0.008334,
  Shape = Shape_shp,
  Keep_Temporary = TRUE,
  Dir = Dir.Covariates
)
## Kriging
Output_HIST &lt;- krigR(
  Data = train_HIST,
  Covariates_coarse = GMTED_DE[[1]], 
  Covariates_fine = GMTED_DE[[2]],  
  Keep_Temporary = FALSE,
  Cores = 1,
  Dir = Dir.Exports,  
  FileName = &quot;DE_CMIP-HIST&quot;, 
  nmax = 40
)
</code></pre>
<pre><code class="language-r">Plot_Krigs(Output_HIST,
           Shp = Shape_shp,
           Dates = &quot;CMIP6 Historical&quot;, columns = 2)
</code></pre>
<p><img src="krigr-projections_files/figure-html/unnamed-chunk-8-1.png" width="1440" /></p>
<h4 id="future-cmip6">Future CMIP6</h4>
<pre><code class="language-r">## Covariate Data
GMTED_DE &lt;- download_DEM(
  Train_ras = train_SSP,
  Target_res = 0.008334,
  Shape = Shape_shp,
  Keep_Temporary = TRUE,
  Dir = Dir.Covariates
)
## Kriging
Output_SSP &lt;- krigR(
  Data = train_SSP,
  Covariates_coarse = GMTED_DE[[1]], 
  Covariates_fine = GMTED_DE[[2]],   
  Keep_Temporary = FALSE,
  Cores = 1,
  Dir = Dir.Exports,  
  FileName = &quot;DE_SSP585_2041-2060&quot;, 
  nmax = 40
)
</code></pre>
<pre><code class="language-r">Plot_Krigs(Output_SSP,
           Shp = Shape_shp,
           Dates = &quot;CMIP6 Future&quot;, columns = 2)
</code></pre>
<p><img src="krigr-projections_files/figure-html/unnamed-chunk-11-1.png" width="1440" /></p>
<h4 id="historical-era5-land">Historical ERA5-Land</h4>
<pre><code class="language-r">## Covariate Data
GMTED_DE &lt;- download_DEM(
  Train_ras = Hist_ERA_ras,
  Target_res = 0.008334,
  Shape = Shape_shp,
  Keep_Temporary = TRUE,
  Dir = Dir.Covariates
)
## Kriging
Output_ERA &lt;- krigR(
  Data = Hist_ERA_ras,
  Covariates_coarse = GMTED_DE[[1]], 
  Covariates_fine = GMTED_DE[[2]],   
  Keep_Temporary = FALSE,
  Cores = 1,
  Dir = Dir.Exports,  
  FileName = &quot;DE_hist&quot;, 
  nmax = 40
)
</code></pre>
<pre><code class="language-r">Plot_Krigs(Output_ERA,
           Shp = Shape_shp,
           Dates = &quot;ERA5-Land Historical&quot;, columns = 2)
</code></pre>
<p><img src="krigr-projections_files/figure-html/unnamed-chunk-14-1.png" width="1440" /></p>
<h3 id="putting-it-all-together">Putting It All Together</h3>
<p>To establish a final product of high-resolution climate projection data, we simply add the difference between the kriged CMIP6 products to the kriged ERA5-Land product:</p>
<pre><code class="language-r">## Creating Difference and Projection raster
Difference_ras &lt;- Output_SSP[[1]] - Output_HIST[[1]]
Projection_ras &lt;- Output_ERA[[1]] + Difference_ras
## Adding min and max values to ocean cells to ensure same colour scale
Output_ERA[[1]][10] &lt;- maxValue(Projection_ras)
Output_ERA[[1]][12] &lt;- minValue(Projection_ras)
Projection_ras[10] &lt;- maxValue(Output_ERA[[1]])
Projection_ras[12] &lt;- minValue(Output_ERA[[1]])
## Individual plots
A_gg &lt;- Plot_Raw(Output_ERA[[1]], Shp = Shape_shp, 
                 Dates = &quot;Historical ERA5-Land (1981-2000)&quot;)
B_gg &lt;- Plot_Raw(Difference_ras[[1]], Shp = Shape_shp, 
                 Dates = &quot;Anomalies of SSP585 - Historical CMIP-6&quot;,
                 COL = rev(viridis(100)))
C_gg &lt;- Plot_Raw(Projection_ras[[1]], Shp = Shape_shp, 
                 Dates = &quot;Future Projection (ERA5-Land + Anomalies)&quot;)
## Fuse the plots into one big plot
ggPlot &lt;- plot_grid(plotlist = list(A_gg, B_gg, C_gg), 
                    ncol = 3, labels = &quot;AUTO&quot;) 
ggPlot
</code></pre>
<p><img src="krigr-projections_files/figure-html/unnamed-chunk-15-1.png" width="1440" /></p>
<p>And there we have it - a downscaled, bias-corrected projection of air temperature across Germany.</p>
<h2 id="considerations-for-projection-kriging">Considerations for Projection Kriging</h2>
<p>Projection kriging is easily the most flexible exercise you can undertake with <code>KrigR</code>.</p>
<div class="alert alert-warning">
  <div>
    I have submitted a research proposal to establish best practice for projection kriging.
  </div>
</div>
<p>So far, two particular aspects stand out to me and should be considered by you when using <code>KrigR</code> to obtain high-resolution projection data.</p>
<div class="alert alert-danger">
  <div>
    <strong>Do not statistically downscale precipitation data and do not use products that do so!</strong>
  </div>
</div>
<h3 id="reliability">Reliability</h3>
<p>Just like with all statistical downscaling exercises, it is pivotal to consider variables interpolated and consistency of statistical relationships with covariates across spatial resolutions.</p>
<div class="alert alert-warning">
  <div>
    Kriging is a very flexible tool for statistical interpolation. Consider your choice of covariates and change in resolutions carefully. <strong>Always inspect your data</strong>.
  </div>
</div>
<h3 id="uncertainty">Uncertainty</h3>
<p>Integration of multiple kriged data sets with statistical uncertainty and each of which comes with its own underlying dynamical data uncertainty raises the question of how to combine uncertainties for meaningful uncertainty flags.</p>
<div class="alert alert-warning">
  <div>
    I have submitted a research proposal to assess best practice for uncertainty integration across data products.
  </div>
</div>
<h2 id="session-info">Session Info</h2>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] mapview_2.11.0          rnaturalearthdata_0.1.0 rnaturalearth_0.3.2    
##  [4] gimms_1.2.1             ggmap_3.0.2             cowplot_1.1.1          
##  [7] viridis_0.6.2           viridisLite_0.4.1       ggplot2_3.4.1          
## [10] tidyr_1.3.0             KrigR_0.1.2             terra_1.7-21           
## [13] httr_1.4.5              stars_0.6-0             abind_1.4-5            
## [16] fasterize_1.0.4         sf_1.0-12               lubridate_1.9.2        
## [19] automap_1.1-9           doSNOW_1.0.20           snow_0.4-4             
## [22] doParallel_1.0.17       iterators_1.0.14        foreach_1.5.2          
## [25] rgdal_1.6-5             raster_3.6-20           sp_1.6-0               
## [28] stringr_1.5.0           keyring_1.3.1           ecmwfr_1.5.0           
## [31] ncdf4_1.21             
## 
## loaded via a namespace (and not attached):
##  [1] leafem_0.2.0             colorspace_2.1-0         class_7.3-21            
##  [4] leaflet_2.1.2            satellite_1.0.4          base64enc_0.1-3         
##  [7] rstudioapi_0.14          proxy_0.4-27             farver_2.1.1            
## [10] fansi_1.0.4              codetools_0.2-19         cachem_1.0.7            
## [13] knitr_1.42               jsonlite_1.8.4           png_0.1-8               
## [16] Kendall_2.2.1            compiler_4.2.3           assertthat_0.2.1        
## [19] fastmap_1.1.1            cli_3.6.0                htmltools_0.5.4         
## [22] tools_4.2.3              gtable_0.3.1             glue_1.6.2              
## [25] dplyr_1.1.0              Rcpp_1.0.10              jquerylib_0.1.4         
## [28] vctrs_0.6.1              blogdown_1.16            crosstalk_1.2.0         
## [31] lwgeom_0.2-11            xfun_0.37                timechange_0.2.0        
## [34] lifecycle_1.0.3          rnaturalearthhires_0.2.1 zoo_1.8-11              
## [37] scales_1.2.1             gstat_2.1-0              yaml_2.3.7              
## [40] curl_5.0.0               memoise_2.0.1            gridExtra_2.3           
## [43] sass_0.4.5               reshape_0.8.9            stringi_1.7.12          
## [46] highr_0.10               e1071_1.7-13             boot_1.3-28.1           
## [49] intervals_0.15.3         RgoogleMaps_1.4.5.3      rlang_1.1.0             
## [52] pkgconfig_2.0.3          bitops_1.0-7             evaluate_0.20           
## [55] lattice_0.20-45          purrr_1.0.1              htmlwidgets_1.6.1       
## [58] labeling_0.4.2           tidyselect_1.2.0         plyr_1.8.8              
## [61] magrittr_2.0.3           bookdown_0.33            R6_2.5.1                
## [64] generics_0.1.3           DBI_1.1.3                pillar_1.8.1            
## [67] withr_2.5.0              units_0.8-1              xts_0.13.0              
## [70] tibble_3.2.1             spacetime_1.2-8          KernSmooth_2.23-20      
## [73] utf8_1.2.3               rmarkdown_2.20           jpeg_0.1-10             
## [76] grid_4.2.3               zyp_0.11-1               FNN_1.1.3.2             
## [79] digest_0.6.31            classInt_0.4-9           webshot_0.5.4           
## [82] stats4_4.2.3             munsell_0.5.0            bslib_0.4.2
</code></pre>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/climate-data/">Climate Data</a>
  
  <a class="badge badge-light" href="/tag/statistical-downscaling/">Statistical Downscaling</a>
  
  <a class="badge badge-light" href="/tag/krigr/">KrigR</a>
  
</div>



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/krigr/third-party/" rel="next">Third-Party Data</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/krigr/" rel="prev">KrigR Workshop</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 2021-05-26</p>

          





          


          


  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/courses/krigr/quickstart/">Quick Guide</a></li>
      
      <li><a href="/courses/krigr/bioclim/">Bioclimatic Variables</a></li>
      
      <li><a href="/courses/krigr/download/">Downloading &amp; Processing</a></li>
      
      <li><a href="/courses/krigr/prep/">Preparing the Workshop</a></li>
      
      <li><a href="/courses/krigr/setup/">Setting up KrigR</a></li>
      
    </ul>
  </div>
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    Â© 2024
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
