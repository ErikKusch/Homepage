<!DOCTYPE html><html lang="en-gb" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Erik Kusch">

  
  
  
    
  
  <meta name="description" content="Answers and solutions to the exercises belonging to chapter 4 in [Bayesian Networks in R with Applications in Systems Biology](https://link.springer.com/book/10.1007/978-1-4614-6446-4) by by Radhakrishnan Nagarajan, Marco Scutari \&amp; Sophie Lèbre and Part 4 in [Bayesian Networks with Examples in R](https://www.bnlearn.com/book-crc/) by M. Scutari and J.-B. Denis.">

  
  <link rel="alternate" hreflang="en-gb" href="https://www.erikkusch.com/courses/bayes-nets/inference/">

  


  
  
  
  <meta name="theme-color" content="#858383">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186216138-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186216138-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.erikkusch.com/courses/bayes-nets/inference/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ErikKusch">
  <meta property="twitter:creator" content="@ErikKusch">
  
  <meta property="og:site_name" content="Erik Kusch">
  <meta property="og:url" content="https://www.erikkusch.com/courses/bayes-nets/inference/">
  <meta property="og:title" content="Bayesian Network Inference | Erik Kusch">
  <meta property="og:description" content="Answers and solutions to the exercises belonging to chapter 4 in [Bayesian Networks in R with Applications in Systems Biology](https://link.springer.com/book/10.1007/978-1-4614-6446-4) by by Radhakrishnan Nagarajan, Marco Scutari \&amp; Sophie Lèbre and Part 4 in [Bayesian Networks with Examples in R](https://www.bnlearn.com/book-crc/) by M. Scutari and J.-B. Denis."><meta property="og:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg">
  <meta property="twitter:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg"><meta property="og:locale" content="en-gb">
  
    
      <meta property="article:published_time" content="2022-11-08T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2022-11-08T20:00:00&#43;01:00">
  

  



  


  


  





  <title>Bayesian Network Inference | Erik Kusch</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses & Workshops</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/krigr/"><span>KrigR - State-of-the-Art Climate Data within R</span></a>
            
              <a class="dropdown-item" href="/courses/gbif/"><span>Accessing and Referencing GBIF Data for Research</span></a>
            
              <a class="dropdown-item" href="/courses/rethinking/"><span>Statistical Rethinking - Introduction to Bayesian Statistics</span></a>
            
              <a class="dropdown-item" href="/courses/bayes-nets/"><span>Bayesian Networks - Causality through Bayesian Approaches</span></a>
            
              <a class="dropdown-item" href="/courses/biostat101/"><span>Biostats 101 - An Introduction to Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/excursions-into-biostatistics/"><span>Biostats 301 - Excursions into Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/bftp-biome-detection/"><span>BFTP - First Steps in Macroecology in R</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/media/CV_ErikKusch.html" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/introduction/">1 - Theory</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/bayes-nets/introduction/">Graph Theory &amp; Bayes</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/networksr/">(Bayesian) Networks &amp; R</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/part-1/">2 - Static Networks</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/bayes-nets/part-1/">Multinomial Bayesian Networks</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/part-2/">Gaussian Bayesian Networks</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/part-3/">Hybrid Bayesian Networks</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/static/">Additional Static Exercises</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/dynamic/">3 - Dynamic Networks</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/bayes-nets/dynamic/">Dynamic Bayesian Networks</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/inference/">4 - Network Inference</a>
    <ul class="nav docs-sidenav">
      
      <li class="active">
        <a href="/courses/bayes-nets/inference/">Bayesian Network Inference</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#material">Material</a></li>
    <li><a href="#exercises">Exercises</a>
      <ul>
        <li><a href="#r-environment"><code>R</code> Environment</a></li>
        <li><a href="#nagarajan-41">Nagarajan 4.1</a></li>
        <li><a href="#nagarajan-42">Nagarajan 4.2</a></li>
        <li><a href="#nagarajan-43">Nagarajan 4.3</a></li>
        <li><a href="#nagarajan-44">Nagarajan 4.4</a></li>
        <li><a href="#scutari-41">Scutari 4.1</a></li>
        <li><a href="#scutari-42">Scutari 4.2</a></li>
        <li><a href="#scutari-43">Scutari 4.3</a></li>
      </ul>
    </li>
    <li><a href="#session-info">Session Info</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Bayesian Network Inference</h1>

          <div class="article-style">
            <style>

blockquote{
color:#633a00;
}

</style>
<h2 id="material">Material</h2>
<p>Most of the material in these chapters has already been covered in previous material, so the following summary is rather brief:</p>
<ul>
<li>
<a href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/content/courses/bayes-nets/8-Bayesian-Network-Inference_08-11-22.html" target="_blank" rel="noopener">Bayesian Network Inference</a></li>
</ul>
<p>Please refer to earlier material for introductions of queries, structure learning, and parameter learning in theory and in <code>R</code>.</p>
<h2 id="exercises">Exercises</h2>
<p>These are answers and solutions to the exercises at the end of chapter 4 in 
<a href="https://link.springer.com/book/10.1007/978-1-4614-6446-4" target="_blank" rel="noopener">Bayesian Networks in R with Applications in Systems Biology</a> by by Radhakrishnan Nagarajan, Marco Scutari &amp; Sophie Lèbre and Part 4 in 
<a href="https://www.bnlearn.com/book-crc/" target="_blank" rel="noopener">Bayesian Networks with Examples in R</a> by M. Scutari and J.-B. Denis. Much of my inspiration for these solutions, where necessary, by consulting the solutions provided by the authors themselves as in the appendix.</p>
<h3 id="r-environment"><code>R</code> Environment</h3>
<p>For today&rsquo;s exercise, I load the following packages:</p>
<pre><code class="language-r">library(bnlearn)
library(gRain)
library(GeneNet)
library(penalized)
</code></pre>
<h3 id="nagarajan-41">Nagarajan 4.1</h3>
<blockquote>
<p>Apply the junction tree algorithm to the validated network structure from Sachs et al. (2005), and draw the resulting undirected triangulated graph.</p>
</blockquote>
<p>Taken directly from the solutions:</p>
<img src="/courses/bayes-nets/Nagarajan4_1.JPG" width="900"/>
<h3 id="nagarajan-42">Nagarajan 4.2</h3>
<blockquote>
<p>Consider the Sachs et al. (2005) data used in Sect. 4.2.</p>
</blockquote>
<p>First, let&rsquo;s read the data in like it was done in the book:</p>
<pre><code class="language-r">isachs &lt;- read.table(&quot;sachs.interventional.txt&quot;, header = TRUE, colClasses = &quot;factor&quot;)
isachs &lt;- isachs[, 1:11]
for (i in names(isachs)) {
  levels(isachs[, i]) &lt;- c(&quot;LOW&quot;, &quot;AVG&quot;, &quot;HIGH&quot;)
}
</code></pre>
<p>This .txt file can be downloaded from 
<a href="https://www.bnlearn.com/book-useR/code/sachs.interventional.txt.gz" target="_blank" rel="noopener">here</a>.</p>
<h4 id="part-a">Part A</h4>
<blockquote>
<p>Perform parameter learning with the <code>bn.fit</code> function from <code>bnlearn</code> and the validated network structure. How do the maximum likelihood estimates differ from the Bayesian ones, and how do the latter vary as the imaginary sample size increases?</p>
</blockquote>
<pre><code class="language-r">sachs_DAG &lt;- model2network(paste0(
  &quot;[PKC][PKA|PKC][praf|PKC:PKA]&quot;,
  &quot;[pmek|PKC:PKA:praf][p44.42|pmek:PKA]&quot;,
  &quot;[pakts473|p44.42:PKA][P38|PKC:PKA]&quot;,
  &quot;[pjnk|PKC:PKA][plcg][PIP3|plcg]&quot;,
  &quot;[PIP2|plcg:PIP3]&quot;
))
f4.1_mle &lt;- bn.fit(sachs_DAG, isachs, method = &quot;mle&quot;)
f4.1_bayes1 &lt;- bn.fit(sachs_DAG, isachs, method = &quot;bayes&quot;, iss = 1)
f4.1_bayes10 &lt;- bn.fit(sachs_DAG, isachs, method = &quot;bayes&quot;, iss = 10)
f4.1_bayes100 &lt;- bn.fit(sachs_DAG, isachs, method = &quot;bayes&quot;, iss = 100)
</code></pre>
<p>I omit the outputs of the individual objects created above here for space.</p>
<p>From a theoretical standpoint mle estimates may contain NA values while bayes-inferred estimates do not. That being said, I did not see any NA outputs in the maximum likelihood estimates here.</p>
<p>As far as iss is concerned, higher iss values result in smoother estimates.</p>
<h4 id="part-b">Part B</h4>
<blockquote>
<p>Node <code>PKA</code> is parent of all the nodes in the <code>praf → pmek → p44.42 → pakts473</code> chain. Use the junction tree algorithm to explore how our beliefs on those nodes change when we have evidence that <code>PKA</code> is <code>“LOW”</code>, and when <code>PKA</code> is <code>“HIGH”</code>.</p>
</blockquote>
<pre><code class="language-r">mle_jtree &lt;- compile(as.grain(f4.1_mle))
query &lt;- c(&quot;praf&quot;, &quot;pmek&quot;, &quot;p44.42&quot;, &quot;pakts473&quot;)

## baseline query
querygrain(mle_jtree, nodes = query)
</code></pre>
<pre><code>## $pmek
## pmek
##       LOW       AVG      HIGH 
## 0.5798148 0.3066667 0.1135185 
## 
## $praf
## praf
##       LOW       AVG      HIGH 
## 0.5112963 0.2835185 0.2051852 
## 
## $p44.42
## p44.42
##       LOW       AVG      HIGH 
## 0.1361111 0.6062963 0.2575926 
## 
## $pakts473
## pakts473
##        LOW        AVG       HIGH 
## 0.60944444 0.31037037 0.08018519
</code></pre>
<pre><code class="language-r">## low evidence
mle_jprop &lt;- setFinding(mle_jtree, nodes = &quot;PKA&quot;, states = &quot;LOW&quot;)
querygrain(mle_jprop, nodes = query)
</code></pre>
<pre><code>## $pmek
## pmek
##        LOW        AVG       HIGH 
## 0.35782443 0.08874046 0.55343511 
## 
## $praf
## praf
##       LOW       AVG      HIGH 
## 0.1145038 0.1746183 0.7108779 
## 
## $p44.42
## p44.42
##       LOW       AVG      HIGH 
## 0.3435115 0.1965649 0.4599237 
## 
## $pakts473
## pakts473
##       LOW       AVG      HIGH 
## 0.2967557 0.2977099 0.4055344
</code></pre>
<pre><code class="language-r">## high evidence
mle_jprop &lt;- setFinding(mle_jtree, nodes = &quot;PKA&quot;, states = &quot;HIGH&quot;)
querygrain(mle_jprop, nodes = query)
</code></pre>
<pre><code>## $pmek
## pmek
##         LOW         AVG        HIGH 
## 0.981418919 0.016891892 0.001689189 
## 
## $praf
## praf
##        LOW        AVG       HIGH 
## 0.83614865 0.13006757 0.03378378 
## 
## $p44.42
## p44.42
##        LOW        AVG       HIGH 
## 0.07263514 0.68918919 0.23817568 
## 
## $pakts473
## pakts473
##       LOW       AVG      HIGH 
## 0.7652027 0.2347973 0.0000000
</code></pre>
<p><code>PKA</code> inhibits all other nodes. When <code>PKA</code> is <code>HIGH</code> then the <code>LOW</code> probability of all other nodes increases.</p>
<p>When <code>PKA</code> is <code>HIGH</code>, the activity of all the proteins corresponding to the query nodes is inhibited (the <code>LOW</code> probability increases and the <code>HIGH</code> decreases). When <code>PKA</code> is <code>LOW</code>, the opposite is true (the LOW probability decreases and the <code>HIGH</code> increases).</p>
<h4 id="part-c">Part C</h4>
<blockquote>
<p>Similarly, explore the effects on <code>pjnk</code> of evidence on <code>PIP2</code>, <code>PIP3</code>, and <code>plcg</code>.</p>
</blockquote>
<pre><code class="language-r">mle_jprop &lt;- setFinding(mle_jtree,
  nodes = c(&quot;PIP2&quot;, &quot;PIP3&quot;, &quot;plcg&quot;),
  states = rep(&quot;LOW&quot;, 3)
)

## baseline query
querygrain(mle_jtree, nodes = &quot;pjnk&quot;)
</code></pre>
<pre><code>## $pjnk
## pjnk
##        LOW        AVG       HIGH 
## 0.53944444 0.38277778 0.07777778
</code></pre>
<pre><code class="language-r">## low evidence
querygrain(mle_jprop, nodes = &quot;pjnk&quot;)
</code></pre>
<pre><code>## $pjnk
## pjnk
##        LOW        AVG       HIGH 
## 0.53944444 0.38277778 0.07777778
</code></pre>
<p>Turns out <code>pjnk</code> is unaffected by the others. The DAG shown in the answers to exercise Nagarajan 4.1 supports this.</p>
<h3 id="nagarajan-43">Nagarajan 4.3</h3>
<blockquote>
<p>Consider the marks data set analyzed in Sect. 2.3.</p>
</blockquote>
<pre><code class="language-r">data(marks)
</code></pre>
<h4 id="part-a-1">Part A</h4>
<blockquote>
<p>Learn both the network structure and the parameters with likelihood based approaches, i.e., BIC or AIC, for structure learning and maximum likelihood estimates for the parameters.</p>
</blockquote>
<pre><code class="language-r">f4.3_dag &lt;- hc(marks, score = &quot;bic-g&quot;)
f4.3_dag
</code></pre>
<pre><code>## 
##   Bayesian network learned via Score-based methods
## 
##   model:
##    [MECH][VECT|MECH][ALG|MECH:VECT][ANL|ALG][STAT|ALG:ANL] 
##   nodes:                                 5 
##   arcs:                                  6 
##     undirected arcs:                     0 
##     directed arcs:                       6 
##   average markov blanket size:           2.40 
##   average neighbourhood size:            2.40 
##   average branching factor:              1.20 
## 
##   learning algorithm:                    Hill-Climbing 
##   score:                                 BIC (Gauss.) 
##   penalization coefficient:              2.238668 
##   tests used in the learning procedure:  34 
##   optimized:                             TRUE
</code></pre>
<pre><code class="language-r">f4.3_bn &lt;- bn.fit(f4.3_dag, marks)
f4.3_bn
</code></pre>
<pre><code>## 
##   Bayesian network parameters
## 
##   Parameters of node MECH (Gaussian distribution)
## 
## Conditional density: MECH
## Coefficients:
## (Intercept)  
##    38.95455  
## Standard deviation of the residuals: 17.48622 
## 
##   Parameters of node VECT (Gaussian distribution)
## 
## Conditional density: VECT | MECH
## Coefficients:
## (Intercept)         MECH  
##  34.3828788    0.4160755  
## Standard deviation of the residuals: 11.01373 
## 
##   Parameters of node ALG (Gaussian distribution)
## 
## Conditional density: ALG | MECH + VECT
## Coefficients:
## (Intercept)         MECH         VECT  
##  25.3619809    0.1833755    0.3577122  
## Standard deviation of the residuals: 8.080725 
## 
##   Parameters of node ANL (Gaussian distribution)
## 
## Conditional density: ANL | ALG
## Coefficients:
## (Intercept)          ALG  
##   -3.574130     0.993156  
## Standard deviation of the residuals: 10.50248 
## 
##   Parameters of node STAT (Gaussian distribution)
## 
## Conditional density: STAT | ALG + ANL
## Coefficients:
## (Intercept)          ALG          ANL  
## -11.1920114    0.7653499    0.3164056  
## Standard deviation of the residuals: 12.60646
</code></pre>
<h4 id="part-b-1">Part B</h4>
<blockquote>
<p>Query the network learned in the previous point for the probability to have the marks for both <code>STAT</code> and <code>MECH</code> above 60, given evidence that the mark for <code>ALG</code> is at most 60. Are the two variables independent given the evidence on <code>ALG</code>?</p>
</blockquote>
<pre><code class="language-r">cpquery(f4.3_bn, event = (STAT &gt; 60) &amp; (MECH &gt; 60), evidence = (ALG &lt;= 60), n = 1e7)
</code></pre>
<pre><code>## [1] 0.009562571
</code></pre>
<pre><code class="language-r">cpquery(f4.3_bn, event = (STAT &gt; 60), evidence = (ALG &lt;= 60), n = 1e7)
</code></pre>
<pre><code>## [1] 0.08289571
</code></pre>
<pre><code class="language-r">cpquery(f4.3_bn, event = (MECH &gt; 60), evidence = (ALG &lt;= 60), n = 1e7)
</code></pre>
<pre><code>## [1] 0.0683385
</code></pre>
<p>The conditional probability of the two outcomes (0.0095912) is not the same as the product of their corresponding marginal probabilities (0.0056668). Conclusively, we can say that <code>STAT</code> and <code>MECH</code> are not independent conditional on <code>ALG</code>.</p>
<h4 id="part-c-1">Part C</h4>
<blockquote>
<p>What is the (conditional) probability of having an average vote (in the [60,70] range) in both <code>VECT</code> and <code>MECH</code> while having an outstanding vote in <code>ALG</code> (at least 90)?</p>
</blockquote>
<pre><code class="language-r">cpquery(f4.3_bn,
  event = ((MECH &gt;= 60) &amp; (MECH &lt;= 70)) | ((VECT &gt;= 60) &amp; (VECT &lt;= 70)),
  evidence = (ALG &gt;= 90),
  n = 1e7
)
</code></pre>
<pre><code>## [1] 0.2872254
</code></pre>
<h3 id="nagarajan-44">Nagarajan 4.4</h3>
<blockquote>
<p>Using the dynamic Bayesian network <code>dbn2</code> from Sect. 4.3, investigate the effects of genes <code>257710_at</code> and <code>255070_at</code> observed at time t-2 on gene <code>265768_at</code> at time t.</p>
</blockquote>
<p>This is the network in the chapter according to the errata corrige 
<a href="https://www.bnlearn.com/book-useR/" target="_blank" rel="noopener">here</a>:</p>
<pre><code class="language-r">data(arth800)
subset &lt;- c(60, 141, 260, 333, 365, 424, 441, 512, 521, 578, 789, 799)
arth12 &lt;- arth800.expr[, subset]
x &lt;- arth12[1:(nrow(arth12) - 2), ]
y &lt;- arth12[-(1:2), &quot;265768_at&quot;]
lambda &lt;- optL1(response = y, penalized = x, trace = FALSE)$lambda
lasso.t &lt;- penalized(response = y, penalized = x, lambda1 = lambda, trace = FALSE)
y &lt;- arth12[-(1:2), &quot;245094_at&quot;]
colnames(x)[12] &lt;- &quot;245094_at1&quot;
lambda &lt;- optL1(response = y, penalized = x, trace = FALSE)$lambda
lasso.s &lt;- penalized(response = y, penalized = x, lambda1 = lambda, trace = FALSE)
## errate comes in here
dbn2 &lt;- empty.graph(c(
  &quot;265768_at&quot;, &quot;245094_at1&quot;,
  &quot;258736_at&quot;, &quot;257710_at&quot;, &quot;255070_at&quot;,
  &quot;245319_at&quot;, &quot;245094_at&quot;
))
dbn2 &lt;- set.arc(dbn2, &quot;245094_at&quot;, &quot;265768_at&quot;)
for (node in names(coef(lasso.s))[-c(1, 6)]) {
  dbn2 &lt;- set.arc(dbn2, node, &quot;245094_at&quot;)
}
dbn2 &lt;- set.arc(dbn2, &quot;245094_at1&quot;, &quot;245094_at&quot;)
dbn2.data &lt;- as.data.frame(x[, nodes(dbn2)[1:6]])
dbn2.data[, &quot;245094_at&quot;] &lt;- y
dbn2.data[, &quot;245094_at1&quot;] &lt;- arth12[2:(nrow(arth12) - 1), &quot;245094_at&quot;]
dbn2.fit &lt;- bn.fit(dbn2, dbn2.data)
## errata stops here
dbn2.fit[[&quot;265768_at&quot;]] &lt;- lasso.t
dbn2.fit[[&quot;245094_at&quot;]] &lt;- lasso.s
</code></pre>
<p>This is the solution to the exercise:</p>
<pre><code class="language-r">set.seed(42)
cpquery(dbn2.fit, event = (`265768_at` &gt; 8), evidence = (`257710_at` &gt; 8))
</code></pre>
<pre><code>## [1] 0.3590734
</code></pre>
<pre><code class="language-r">cpquery(dbn2.fit, event = (`265768_at` &gt; 8), evidence = (`255070_at` &gt; 8))
</code></pre>
<pre><code>## [1] 0.5753049
</code></pre>
<pre><code class="language-r">cpquery(dbn2.fit, event = (`265768_at` &gt; 8), evidence = TRUE)
</code></pre>
<pre><code>## [1] 0.4396
</code></pre>
<p>High expression levels of gene 257710_at at time t −2 reduce the probability of high expression levels of gene 265768_at at time t; the opposite is true for gene 255070_at.</p>
<h3 id="scutari-41">Scutari 4.1</h3>
<blockquote>
<p>Consider the survey data set from Chapter 1.</p>
</blockquote>
<p>The data can be obtained from 
<a href="https://www.bnlearn.com/book-crc/" target="_blank" rel="noopener">here</a>:</p>
<pre><code class="language-r">survey &lt;- read.table(&quot;survey.txt&quot;, header = TRUE, colClasses = &quot;factor&quot;)
</code></pre>
<p>Remember, this is the corresponding DAG we know to be true:</p>
<img src="/courses/networksscutari/Fig1.1.JPG" width="900"/>
<h4 id="part-a-2">Part A</h4>
<blockquote>
<p>Learn a BN with the IAMB algorithm and the asymptotic mutual information test.</p>
</blockquote>
<pre><code class="language-r">s4.1_dag &lt;- iamb(survey, test = &quot;mi&quot;)
s4.1_dag
</code></pre>
<pre><code>## 
##   Bayesian network learned via Constraint-based methods
## 
##   model:
##     [undirected graph]
##   nodes:                                 6 
##   arcs:                                  4 
##     undirected arcs:                     4 
##     directed arcs:                       0 
##   average markov blanket size:           1.33 
##   average neighbourhood size:            1.33 
##   average branching factor:              0.00 
## 
##   learning algorithm:                    IAMB 
##   conditional independence test:         Mutual Information (disc.) 
##   alpha threshold:                       0.05 
##   tests used in the learning procedure:  85
</code></pre>
<h4 id="part-b-2">Part B</h4>
<blockquote>
<p>Learn a second BN with IAMB but using only the first 100 observations of the data set. Is there a significant loss of information in the resulting BN compared to the BN learned from the whole data set?</p>
</blockquote>
<pre><code class="language-r">s4.1_dagB &lt;- iamb(survey[1:1e2, ], test = &quot;mi&quot;)
s4.1_dagB
</code></pre>
<pre><code>## 
##   Bayesian network learned via Constraint-based methods
## 
##   model:
##     [undirected graph]
##   nodes:                                 6 
##   arcs:                                  1 
##     undirected arcs:                     1 
##     directed arcs:                       0 
##   average markov blanket size:           0.33 
##   average neighbourhood size:            0.33 
##   average branching factor:              0.00 
## 
##   learning algorithm:                    IAMB 
##   conditional independence test:         Mutual Information (disc.) 
##   alpha threshold:                       0.05 
##   tests used in the learning procedure:  42
</code></pre>
<p>We discover far fewer arcs!</p>
<h4 id="part-c-2">Part C</h4>
<blockquote>
<p>Repeat the structure learning in the previous point with IAMB and the Monte Carlo and sequential Monte Carlo mutual information tests. How do the resulting networks compare with the BN learned with the asymptotic test? Is the increased execution time justified?</p>
</blockquote>
<pre><code class="language-r">s4.1_dagC_mcmc &lt;- iamb(survey[1:1e2, ], test = &quot;mc-mi&quot;)
s4.1_dagC_mcmc
</code></pre>
<pre><code>## 
##   Bayesian network learned via Constraint-based methods
## 
##   model:
##     [undirected graph]
##   nodes:                                 6 
##   arcs:                                  1 
##     undirected arcs:                     1 
##     directed arcs:                       0 
##   average markov blanket size:           0.33 
##   average neighbourhood size:            0.33 
##   average branching factor:              0.00 
## 
##   learning algorithm:                    IAMB 
##   conditional independence test:         Mutual Information (disc., MC) 
##   alpha threshold:                       0.05 
##   permutations:                          5000 
##   tests used in the learning procedure:  38
</code></pre>
<pre><code class="language-r">s4.1_dagC_smc &lt;- iamb(survey[1:1e2, ], test = &quot;smc-mi&quot;)
s4.1_dagC_smc
</code></pre>
<pre><code>## 
##   Bayesian network learned via Constraint-based methods
## 
##   model:
##     [undirected graph]
##   nodes:                                 6 
##   arcs:                                  1 
##     undirected arcs:                     1 
##     directed arcs:                       0 
##   average markov blanket size:           0.33 
##   average neighbourhood size:            0.33 
##   average branching factor:              0.00 
## 
##   learning algorithm:                    IAMB 
##   conditional independence test:         Mutual Information (disc., Seq. MC) 
##   alpha threshold:                       0.05 
##   permutations:                          5000 
##   tests used in the learning procedure:  38
</code></pre>
<p>We do not discover more arcs, and the outputs of the two asymptotic tests are equal for this case:</p>
<pre><code class="language-r">all.equal(s4.1_dagC_mcmc, s4.1_dagC_smc, s4.1_dagB)
</code></pre>
<pre><code>## [1] TRUE
</code></pre>
<h3 id="scutari-42">Scutari 4.2</h3>
<blockquote>
<p>Consider again the survey data set from Chapter 1.</p>
</blockquote>
<p>The data can be obtained from 
<a href="https://www.bnlearn.com/book-crc/" target="_blank" rel="noopener">here</a>:</p>
<pre><code class="language-r">survey &lt;- read.table(&quot;survey.txt&quot;, header = TRUE, colClasses = &quot;factor&quot;)
</code></pre>
<h4 id="part-a-3">Part A</h4>
<blockquote>
<p>Learn a BN using Bayesian posteriors for both structure and parameter learning, in both cases with <code>iss = 5</code>.</p>
</blockquote>
<pre><code class="language-r">s4.2_dag &lt;- hc(survey, score = &quot;bde&quot;, iss = 5)
s4.2_bn &lt;- bn.fit(s4.2_dag, survey, method = &quot;bayes&quot;, iss = 5)
modelstring(s4.2_bn)
</code></pre>
<pre><code>## [1] &quot;[R][E|R][T|R][A|E][O|E][S|E]&quot;
</code></pre>
<h4 id="part-b-3">Part B</h4>
<blockquote>
<p>Repeat structure learning with hc and 3 random restarts and with tabu. How do the BNs differ? Is there any evidence of numerical or convergence problems?</p>
</blockquote>
<pre><code class="language-r">s4.2_hc &lt;- hc(survey, score = &quot;bde&quot;, iss = 5, restart = 3)
modelstring(s4.2_hc)
</code></pre>
<pre><code>## [1] &quot;[T][R|T][E|R][A|E][O|E][S|E]&quot;
</code></pre>
<pre><code class="language-r">s4.2_tabu &lt;- tabu(survey, score = &quot;bde&quot;, iss = 5)
modelstring(s4.2_tabu)
</code></pre>
<pre><code>## [1] &quot;[O][S][E|O:S][A|E][R|E][T|R]&quot;
</code></pre>
<p>The Bayesian networks inferred here differ quite substantially in their DAG structures.</p>
<p>The random-start hill-climbing algorithm builds a DAG structure closer to the validated structure which is supported by the <code>score</code>:</p>
<pre><code class="language-r">score(s4.2_hc, survey)
</code></pre>
<pre><code>## [1] -1998.432
</code></pre>
<pre><code class="language-r">score(s4.2_tabu, survey)
</code></pre>
<pre><code>## [1] -1999.733
</code></pre>
<h4 id="part-c-3">Part C</h4>
<blockquote>
<p>Use increasingly large subsets of the survey data to check empirically that BIC and BDe are asymptotically equivalent.</p>
</blockquote>
<pre><code class="language-r">set.seed(42)
breaks &lt;- seq(from = 10, to = 100, by = 10) # percentage of data
analysis_df &lt;- data.frame(
  bde = NA,
  bic = NA,
  breaks = NA
)
for (k in 1:1e3) {
  bde_vec &lt;- c()
  bic_vec &lt;- c()
  for (i in breaks) {
    samp &lt;- sample(1:nrow(survey), nrow(survey) / i)
    samp &lt;- survey[samp, ]
    s4.2_bde &lt;- hc(samp, score = &quot;bde&quot;, iss = 5)
    s4.2_bic &lt;- hc(samp, score = &quot;bic&quot;)
    bde_vec &lt;- c(bde_vec, score(s4.2_bde, survey))
    bic_vec &lt;- c(bic_vec, score(s4.2_bic, survey))
  }
  analysis_df &lt;- rbind(
    analysis_df,
    data.frame(
      bde = bde_vec,
      bic = bic_vec,
      breaks = breaks
    )
  )
}

analysis_df &lt;- na.omit(analysis_df)

plot(
  x = analysis_df$breaks,
  y = abs(analysis_df$bde - analysis_df$bic)
)
</code></pre>
<p><img src="2022-11-08-network-inference_files/figure-html/unnamed-chunk-21-1.png" width="1440" /></p>
<h3 id="scutari-43">Scutari 4.3</h3>
<blockquote>
<p>Consider the marks data set from Section 4.7.</p>
</blockquote>
<pre><code class="language-r">data(marks)
</code></pre>
<h4 id="part-a-4">Part A</h4>
<blockquote>
<p>Create a bn object describing the graph in the bottom right panel of Figure 4.5 and call it <code>mdag</code>.</p>
</blockquote>
<pre><code class="language-r">mdag &lt;- model2network(paste0(
  &quot;[ANL][MECH][LAT|ANL:MECH]&quot;,
  &quot;[VECT|LAT][ALG|LAT][STAT|LAT]&quot;
))
</code></pre>
<h4 id="part-b-4">Part B</h4>
<blockquote>
<p>Construct the skeleton, the CPDAG and the moral graph of <code>mdag</code>.</p>
</blockquote>
<pre><code class="language-r">mdag_skel &lt;- skeleton(mdag)
mdag_cpdag &lt;- cpdag(mdag)
mdag_moral &lt;- moral(mdag)
</code></pre>
<h4 id="part-c-4">Part C</h4>
<blockquote>
<p>Discretise the marks data using &ldquo;interval&rdquo; discretisation with 2, 3 and 4 intervals.</p>
</blockquote>
<pre><code class="language-r">dmarks_2 &lt;- discretize(marks, &quot;interval&quot;, breaks = 2)
dmarks_3 &lt;- discretize(marks, &quot;interval&quot;, breaks = 3)
dmarks_4 &lt;- discretize(marks, &quot;interval&quot;, breaks = 4)
</code></pre>
<h4 id="part-d">Part D</h4>
<blockquote>
<p>Perform structure learning with hc on each of the discretised data sets; how do the resulting DAGs differ?</p>
</blockquote>
<pre><code class="language-r">hc_2 &lt;- hc(dmarks_2)
modelstring(hc_2)
</code></pre>
<pre><code>## [1] &quot;[MECH][VECT|MECH][ALG|VECT][ANL|ALG][STAT|ALG]&quot;
</code></pre>
<pre><code class="language-r">hc_3 &lt;- hc(dmarks_3)
modelstring(hc_3)
</code></pre>
<pre><code>## [1] &quot;[MECH][ALG|MECH][ANL|ALG][STAT|ALG][VECT|ANL]&quot;
</code></pre>
<pre><code class="language-r">hc_4 &lt;- hc(dmarks_4)
modelstring(hc_4)
</code></pre>
<pre><code>## [1] &quot;[MECH][VECT][ALG][ANL|ALG][STAT|ANL]&quot;
</code></pre>
<p>Quite evidently, as we increase the number of intervals, we break conditional relationships so much so that fewer arcs are identified.</p>
<h2 id="session-info">Session Info</h2>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.2.1 (2022-06-23 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19044)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Germany.utf8  LC_CTYPE=English_Germany.utf8    LC_MONETARY=English_Germany.utf8 LC_NUMERIC=C                     LC_TIME=English_Germany.utf8    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] penalized_0.9-52    survival_3.4-0      GeneNet_1.2.16      fdrtool_1.2.17      longitudinal_1.1.13 corpcor_1.6.10      gRain_1.3.11        gRbase_1.8.7        bnlearn_4.8.1      
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.9          highr_0.9           bslib_0.4.0         compiler_4.2.1      BiocManager_1.30.18 jquerylib_0.1.4     R.methodsS3_1.8.2   R.utils_2.12.0      tools_4.2.1        
## [10] digest_0.6.29       jsonlite_1.8.0      evaluate_0.16       R.cache_0.16.0      lattice_0.20-45     pkgconfig_2.0.3     rlang_1.0.5         igraph_1.3.4        Matrix_1.5-1       
## [19] graph_1.74.0        cli_3.3.0           rstudioapi_0.14     Rgraphviz_2.40.0    yaml_2.3.5          parallel_4.2.1      blogdown_1.13       xfun_0.33           fastmap_1.1.0      
## [28] styler_1.8.0        stringr_1.4.1       knitr_1.40          vctrs_0.4.1         sass_0.4.2          stats4_4.2.1        grid_4.2.1          R6_2.5.1            RBGL_1.72.0        
## [37] rmarkdown_2.16      bookdown_0.29       purrr_0.3.4         magrittr_2.0.3      splines_4.2.1       BiocGenerics_0.42.0 htmltools_0.5.3     stringi_1.7.8       cachem_1.0.6       
## [46] R.oo_1.25.0
</code></pre>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/bayes/">Bayes</a>
  
  <a class="badge badge-light" href="/tag/networks/">Networks</a>
  
  <a class="badge badge-light" href="/tag/bayesian-statistics/">Bayesian Statistics</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
</div>



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/bayes-nets/dynamic/" rel="prev">Dynamic Bayesian Networks</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 2022-11-08</p>

          





          


          


  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/courses/bayes-nets/dynamic/">Dynamic Bayesian Networks</a></li>
      
      <li><a href="/courses/bayes-nets/static/">Additional Static Exercises</a></li>
      
      <li><a href="/courses/bayes-nets/networksr/">(Bayesian) Networks &amp; R</a></li>
      
      <li><a href="/courses/bayes-nets/introduction/">Graph Theory &amp; Bayes</a></li>
      
      <li><a href="/courses/bayes-nets/part-3/">Hybrid Bayesian Networks</a></li>
      
    </ul>
  </div>
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    © 2024
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
