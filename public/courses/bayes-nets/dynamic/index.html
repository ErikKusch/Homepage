<!DOCTYPE html><html lang="en-gb" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Erik Kusch">

  
  
  
    
  
  <meta name="description" content="Answers and solutions to the exercises belonging to chapter 3 in [Bayesian Networks in R with Applications in Systems Biology](https://link.springer.com/book/10.1007/978-1-4614-6446-4) by by Radhakrishnan Nagarajan, Marco Scutari \&amp; Sophie Lèbre.">

  
  <link rel="alternate" hreflang="en-gb" href="https://www.erikkusch.com/courses/bayes-nets/dynamic/">

  


  
  
  
  <meta name="theme-color" content="#858383">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
    
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cutive+Mono%7CLora:400,700%7CRoboto:400,700&display=swap">
    
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-186216138-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-186216138-1', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu7658c99d512131214e4d6c003a3f85f7_112593_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://www.erikkusch.com/courses/bayes-nets/dynamic/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@ErikKusch">
  <meta property="twitter:creator" content="@ErikKusch">
  
  <meta property="og:site_name" content="Erik Kusch">
  <meta property="og:url" content="https://www.erikkusch.com/courses/bayes-nets/dynamic/">
  <meta property="og:title" content="Dynamic Bayesian Networks | Erik Kusch">
  <meta property="og:description" content="Answers and solutions to the exercises belonging to chapter 3 in [Bayesian Networks in R with Applications in Systems Biology](https://link.springer.com/book/10.1007/978-1-4614-6446-4) by by Radhakrishnan Nagarajan, Marco Scutari \&amp; Sophie Lèbre."><meta property="og:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg">
  <meta property="twitter:image" content="https://www.erikkusch.com/img/%C3%A5motdalshytta.jpg"><meta property="og:locale" content="en-gb">
  
    
      <meta property="article:published_time" content="2022-11-01T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2022-11-01T20:00:00&#43;01:00">
  

  



  


  


  





  <title>Dynamic Bayesian Networks | Erik Kusch</title>

</head>
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  








  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_huab2266ff59bbac6a094b6da1268adcf9_208479_0x70_resize_lanczos_2.png" alt="Erik Kusch"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses & Workshops</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/courses/krigr/"><span>KrigR - State-of-the-Art Climate Data within R</span></a>
            
              <a class="dropdown-item" href="/courses/gbif/"><span>Accessing and Referencing GBIF Data for Research</span></a>
            
              <a class="dropdown-item" href="/courses/rethinking/"><span>Statistical Rethinking - Introduction to Bayesian Statistics</span></a>
            
              <a class="dropdown-item" href="/courses/bayes-nets/"><span>Bayesian Networks - Causality through Bayesian Approaches</span></a>
            
              <a class="dropdown-item" href="/courses/biostat101/"><span>Biostats 101 - An Introduction to Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/excursions-into-biostatistics/"><span>Biostats 301 - Excursions into Biostatistics</span></a>
            
              <a class="dropdown-item" href="/courses/bftp-biome-detection/"><span>BFTP - First Steps in Macroecology in R</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#featured"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/about"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/static/media/CV_ErikKusch.html" target="_blank" rel="noopener"><span>CV</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  

<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      





  
    
  




<form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <input name="q" type="search" class="form-control" placeholder="Search..." autocomplete="off">
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  

  
  
  
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/">Overview</a>

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/introduction/">1 - Theory</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/bayes-nets/introduction/">Graph Theory &amp; Bayes</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/networksr/">(Bayesian) Networks &amp; R</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/part-1/">2 - Static Networks</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/bayes-nets/part-1/">Multinomial Bayesian Networks</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/part-2/">Gaussian Bayesian Networks</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/part-3/">Hybrid Bayesian Networks</a>
      </li>
      
      <li >
        <a href="/courses/bayes-nets/static/">Additional Static Exercises</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/dynamic/">3 - Dynamic Networks</a>
    <ul class="nav docs-sidenav">
      
      <li class="active">
        <a href="/courses/bayes-nets/dynamic/">Dynamic Bayesian Networks</a>
      </li>
      
    </ul>
    

  </div>
  
  <div class="docs-toc-item">
    <a class="docs-toc-link" href="/courses/bayes-nets/inference/">4 - Network Inference</a>
    <ul class="nav docs-sidenav">
      
      <li >
        <a href="/courses/bayes-nets/inference/">Bayesian Network Inference</a>
      </li>
      
    </ul>
    

  </div>
  
  
</nav>

    </div>

    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#material">Material</a></li>
    <li><a href="#exercises">Exercises</a>
      <ul>
        <li><a href="#r-environment"><code>R</code> Environment</a></li>
        <li><a href="#nagarajan-31">Nagarajan 3.1</a></li>
        <li><a href="#nagarajan-32">Nagarajan 3.2</a></li>
        <li><a href="#nagarajan-33">Nagarajan 3.3</a></li>
      </ul>
    </li>
    <li><a href="#session-info">Session Info</a></li>
  </ul>
</nav>

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          <h1>Dynamic Bayesian Networks</h1>

          <div class="article-style">
            <style>

blockquote{
color:#633a00;
}

</style>
<h2 id="material">Material</h2>
<ul>
<li>
<a href="https://htmlpreview.github.io/?https://github.com/ErikKusch/Homepage/blob/master/content/courses/bayes-nets/Dynamic-BNs.html" target="_blank" rel="noopener">Dynamic Bayesian Networks</a> by 
<a href="https://gregor-mathes.netlify.app/" target="_blank" rel="noopener">Gregor Mathes</a> (one of our study group members)</li>
</ul>
<h2 id="exercises">Exercises</h2>
<p>These are answers and solutions to the exercises at the end of chapter 3 in 
<a href="https://link.springer.com/book/10.1007/978-1-4614-6446-4" target="_blank" rel="noopener">Bayesian Networks in R with Applications in Systems Biology</a> by by Radhakrishnan Nagarajan, Marco Scutari &amp; Sophie Lèbre. Much of my inspiration for these solutions, where necessary, by consulting the solutions provided by the authors themselves as in the appendix.</p>
<h3 id="r-environment"><code>R</code> Environment</h3>
<p>For today&rsquo;s exercise, I load the following packages:</p>
<pre><code class="language-r">library(vars)
library(lars)
library(GeneNet)
library(G1DBN) # might have to run remotes::install_version(&quot;G1DBN&quot;, &quot;3.1.1&quot;) first
</code></pre>
<h3 id="nagarajan-31">Nagarajan 3.1</h3>
<blockquote>
<p>Consider the <code>Canada</code> data set from the vars package, which we analyzed in Sect. 3.5.1.</p>
</blockquote>
<pre><code class="language-r">data(Canada)
</code></pre>
<h4 id="part-a">Part A</h4>
<blockquote>
<p>Load the data set from the <code>vars</code> package and investigate its properties using the exploratory analysis techniques covered in Chap. 1.</p>
</blockquote>
<pre><code class="language-r">str(Canada)
</code></pre>
<pre><code>##  Time-Series [1:84, 1:4] from 1980 to 2001: 930 930 930 931 933 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:4] &quot;e&quot; &quot;prod&quot; &quot;rw&quot; &quot;U&quot;
</code></pre>
<pre><code class="language-r">summary(Canada)
</code></pre>
<pre><code>##        e              prod             rw              U         
##  Min.   :928.6   Min.   :401.3   Min.   :386.1   Min.   : 6.700  
##  1st Qu.:935.4   1st Qu.:404.8   1st Qu.:423.9   1st Qu.: 7.782  
##  Median :946.0   Median :406.5   Median :444.4   Median : 9.450  
##  Mean   :944.3   Mean   :407.8   Mean   :440.8   Mean   : 9.321  
##  3rd Qu.:950.0   3rd Qu.:410.7   3rd Qu.:461.1   3rd Qu.:10.607  
##  Max.   :961.8   Max.   :418.0   Max.   :470.0   Max.   :12.770
</code></pre>
<h4 id="part-b">Part B</h4>
<blockquote>
<p>Estimate a VAR(1) process for this data set.</p>
</blockquote>
<pre><code class="language-r">(var1 &lt;- VAR(Canada, p = 1, type = &quot;const&quot;))
</code></pre>
<pre><code>## 
## VAR Estimation Results:
## ======================= 
## 
## Estimated coefficients for equation e: 
## ====================================== 
## Call:
## e = e.l1 + prod.l1 + rw.l1 + U.l1 + const 
## 
##          e.l1       prod.l1         rw.l1          U.l1         const 
##    1.17353629    0.14479389   -0.07904568    0.52438144 -192.56360758 
## 
## 
## Estimated coefficients for equation prod: 
## ========================================= 
## Call:
## prod = e.l1 + prod.l1 + rw.l1 + U.l1 + const 
## 
##         e.l1      prod.l1        rw.l1         U.l1        const 
##   0.08709510   1.01970070  -0.02629309   0.32299246 -81.55109611 
## 
## 
## Estimated coefficients for equation rw: 
## ======================================= 
## Call:
## rw = e.l1 + prod.l1 + rw.l1 + U.l1 + const 
## 
##        e.l1     prod.l1       rw.l1        U.l1       const 
##  0.06381103 -0.13551199  0.96872851 -0.19538479 11.61375726 
## 
## 
## Estimated coefficients for equation U: 
## ====================================== 
## Call:
## U = e.l1 + prod.l1 + rw.l1 + U.l1 + const 
## 
##         e.l1      prod.l1        rw.l1         U.l1        const 
##  -0.19293575  -0.08086896   0.07538624   0.47530976 186.80892410
</code></pre>
<h4 id="part-c">Part C</h4>
<blockquote>
<p>Build the auto-regressive matrix $A$ and the constant matrix $B$ defining the VAR(1) model.</p>
</blockquote>
<pre><code class="language-r">## base object creation
base_mat &lt;- matrix(0, 4, 5)
colnames(base_mat) &lt;- c(&quot;e&quot;, &quot;prod&quot;, &quot;rw&quot;, &quot;U&quot;, &quot;constant&quot;)
p &lt;- 0.05
## object filling
pos &lt;- which(coef(var1)$e[, &quot;Pr(&gt;|t|)&quot;] &lt; p)
base_mat[1, pos] &lt;- coef(var1)$e[pos, &quot;Estimate&quot;]
pos &lt;- which(coef(var1)$prod[, &quot;Pr(&gt;|t|)&quot;] &lt; p)
base_mat[2, pos] &lt;- coef(var1)$prod[pos, &quot;Estimate&quot;]
pos &lt;- which(coef(var1)$rw[, &quot;Pr(&gt;|t|)&quot;] &lt; p)
base_mat[3, pos] &lt;- coef(var1)$rw[pos, &quot;Estimate&quot;]
pos &lt;- which(coef(var1)$U[, &quot;Pr(&gt;|t|)&quot;] &lt; p)
base_mat[4, pos] &lt;- coef(var1)$U[pos, &quot;Estimate&quot;]
## final objects
(A &lt;- base_mat[, 1:4])
</code></pre>
<pre><code>##               e        prod          rw         U
## [1,]  1.1735363  0.14479389 -0.07904568 0.5243814
## [2,]  0.0000000  1.01970070  0.00000000 0.0000000
## [3,]  0.0000000 -0.13551199  0.96872851 0.0000000
## [4,] -0.1929358 -0.08086896  0.07538624 0.4753098
</code></pre>
<pre><code class="language-r">(B &lt;- base_mat[, 5])
</code></pre>
<pre><code>## [1] -192.5636    0.0000    0.0000  186.8089
</code></pre>
<h4 id="part-d">Part D</h4>
<blockquote>
<p>Compare the results with the LASSO matrix when estimating the L1-penalty with cross-validation.</p>
</blockquote>
<pre><code class="language-r">## data preparation
data_df &lt;- Canada[-nrow(Canada), ] # remove last row of data
## Lasso
Lasso_ls &lt;- lapply(colnames(Canada), function(gene) {
  y &lt;- Canada[-1, gene] # remove first row of data, and select only target gene
  lars(y = y, x = data_df, type = &quot;lasso&quot;) # LASSO matrix
})
## Cross-validation
CV_ls &lt;- lapply(1:ncol(Canada), function(gene) {
  y &lt;- Canada[-1, gene] # remove first row of data, and select only target gene
  lasso.cv &lt;- cv.lars(y = y, x = data_df, mode = &quot;fraction&quot;)
  frac &lt;- lasso.cv$index[which.min(lasso.cv$cv)]
  predict(Lasso_ls[[gene]], s = frac, type = &quot;coef&quot;, mode = &quot;fraction&quot;)
})
## output
rbind(
  CV_ls[[1]]$coefficients,
  CV_ls[[2]]$coefficients,
  CV_ls[[3]]$coefficients,
  CV_ls[[4]]$coefficients
)
</code></pre>
<pre><code>##                e        prod           rw          U
## [1,]  1.17353629  0.14479389 -0.079045685  0.5243814
## [2,]  0.02570001  1.02314558 -0.004878295  0.1994059
## [3,]  0.09749788 -0.11991692  0.954389035 -0.1023845
## [4,] -0.17604953 -0.08192783  0.069502065  0.5086115
</code></pre>
<p>And for comparison the previously identified $A$:</p>
<pre><code class="language-r">A
</code></pre>
<pre><code>##               e        prod          rw         U
## [1,]  1.1735363  0.14479389 -0.07904568 0.5243814
## [2,]  0.0000000  1.01970070  0.00000000 0.0000000
## [3,]  0.0000000 -0.13551199  0.96872851 0.0000000
## [4,] -0.1929358 -0.08086896  0.07538624 0.4753098
</code></pre>
<h4 id="part-e">Part E</h4>
<blockquote>
<p>What can you conclude?</p>
</blockquote>
<p>The whole point of LASSO, as far as I understand it, is to shrink parameter estimates towards 0 often times reaching 0 exactly. In the above this has not happened for many parameters, but is the case with the estimation provided by <code>vars</code>. I assume this might be because there just aren&rsquo;t enough variables and/or observations in time.</p>
<h3 id="nagarajan-32">Nagarajan 3.2</h3>
<blockquote>
<p>Consider the <code>arth800</code> data set from the GeneNet package, which we analyzed in Sects. 3.5.2 and 3.5.3.</p>
</blockquote>
<pre><code class="language-r">data(arth800)
data(arth800.expr)
</code></pre>
<h4 id="part-a-1">Part A</h4>
<blockquote>
<p>Load the data set from the <code>GeneNet</code> package. The time series expression of the 800 genes is included in a data set called <code>arth800.expr</code>. Investigate its properties using the exploratory analysis techniques covered in Chap. 1.</p>
</blockquote>
<pre><code class="language-r">str(arth800.expr)
</code></pre>
<pre><code>##  'longitudinal' num [1:22, 1:800] 10.04 10.11 9.77 10.06 10.02 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:22] &quot;0-1&quot; &quot;0-2&quot; &quot;1-1&quot; &quot;1-2&quot; ...
##   ..$ : chr [1:800] &quot;AFFX-Athal-GAPDH_3_s_at&quot; &quot;AFFX-Athal-Actin_3_f_at&quot; &quot;267612_at&quot; &quot;267520_at&quot; ...
##  - attr(*, &quot;time&quot;)= num [1:11] 0 1 2 4 8 12 13 14 16 20 ...
##  - attr(*, &quot;repeats&quot;)= num [1:11] 2 2 2 2 2 2 2 2 2 2 ...
</code></pre>
<pre><code class="language-r">summary(arth800.expr)
</code></pre>
<pre><code>## Longitudinal data:
##  800 variables measured at 11 different time points
##  Total number of measurements per variable: 22 
##  Repeated measurements: yes 
## 
##  To obtain the measurement design call 'get.time.repeats()'.
</code></pre>
<h4 id="part-b-1">Part B</h4>
<blockquote>
<p>For this practical exercise, we will work on a subset of variables (one for each gene) having a large variance. Compute the variance of each of the 800 variables, plot the various variance values in decreasing order, and create a data set with the variables greater than 2.</p>
</blockquote>
<pre><code class="language-r">## variance calculation
variance &lt;- diag(var(arth800.expr))
## plotting
plot(sort(variance, decreasing = TRUE), type = &quot;l&quot;, ylab = &quot;Variance&quot;)
abline(h = 2, lty = 2)
</code></pre>
<p><img src="2022-11-01-nagara-dynamic_files/figure-html/unnamed-chunk-10-1.png" width="1440" /></p>
<pre><code class="language-r">## variables with variances greater than 2
dataVar2 &lt;- arth800.expr[, which(variance &gt; 2)]
dim(dataVar2)
</code></pre>
<pre><code>## [1] 22 49
</code></pre>
<h4 id="part-c-1">Part C</h4>
<blockquote>
<p>Can you fit a VAR process with a usual approach from this data set?</p>
</blockquote>
<p>I don&rsquo;t think so. There are more variables (genes) than there are samples (time steps):</p>
<pre><code class="language-r">dim(dataVar2)
</code></pre>
<pre><code>## [1] 22 49
</code></pre>
<h4 id="part-d-1">Part D</h4>
<blockquote>
<p>Which alternative approaches can be used to fit a VAR process from this data set?</p>
</blockquote>
<p>The chapter discusses these alternatives:</p>
<ul>
<li>LASSO</li>
<li>James-Stein Shrinkage</li>
<li>Low-order conditional dependency approximation</li>
</ul>
<h4 id="part-e-1">Part E</h4>
<blockquote>
<p>Estimate a dynamic Bayesian network with each of the alternative approaches presented in this chapter.</p>
</blockquote>
<p>First, I prepare the data by re-ordering them:</p>
<pre><code class="language-r">## make the data sequential for both repetitions
dataVar2seq &lt;- dataVar2[c(seq(1, 22, by = 2), seq(2, 22, by = 2)), ]
</code></pre>
<p><em>LASSO</em> with the <code>lars</code> package:</p>
<pre><code class="language-r">x &lt;- dataVar2seq[-c(21:22), ] # remove final rows (end of sequences)
Lasso_ls &lt;- lapply(colnames(dataVar2seq), function(gene) {
  y &lt;- dataVar2seq[-(1:2), gene]
  lars(y = y, x = x, type = &quot;lasso&quot;)
})
CV_ls &lt;- lapply(1:ncol(dataVar2seq), function(gene) {
  y &lt;- dataVar2seq[-(1:2), gene]
  lasso.cv &lt;- cv.lars(y = y, x = x, mode = &quot;fraction&quot;, plot.it = FALSE)
  frac &lt;- lasso.cv$index[which.min(lasso.cv$cv)]
  predict(Lasso_ls[[gene]], s = frac, type = &quot;coef&quot;, mode = &quot;fraction&quot;)
})
Lasso_mat &lt;- matrix(0, dim(dataVar2seq)[2], dim(dataVar2seq)[2])
for (i in 1:dim(Lasso_mat)[1]) {
  Lasso_mat[i, ] &lt;- CV_ls[i][[1]]$coefficients
}
sum(Lasso_mat != 0) # number of arcs
</code></pre>
<pre><code>## [1] 456
</code></pre>
<pre><code class="language-r">plot(sort(abs(Lasso_mat), decr = TRUE)[1:500], type = &quot;l&quot;, ylab = &quot;Absolute coefficients&quot;)
</code></pre>
<p><img src="2022-11-01-nagara-dynamic_files/figure-html/unnamed-chunk-13-1.png" width="1440" /></p>
<p><em>James-Stein shrinkage</em> with the <code>GeneNet</code> package:</p>
<pre><code class="language-r">DBNGeneNet &lt;- ggm.estimate.pcor(dataVar2, method = &quot;dynamic&quot;)
</code></pre>
<pre><code>## Estimating optimal shrinkage intensity lambda (correlation matrix): 0.0539
</code></pre>
<pre><code class="language-r">DBNGeneNet.edges &lt;- network.test.edges(DBNGeneNet) # p-values, q-values and posterior probabilities for each potential arc
</code></pre>
<pre><code>## Estimate (local) false discovery rates (partial correlations):
## Step 1... determine cutoff point
## Step 2... estimate parameters of null distribution and eta0
## Step 3... compute p-values and estimate empirical PDF/CDF
## Step 4... compute q-values and local fdr
## Step 5... prepare for plotting
</code></pre>
<p><img src="2022-11-01-nagara-dynamic_files/figure-html/unnamed-chunk-14-1.png" width="1440" /></p>
<pre><code class="language-r">plot(DBNGeneNet.edges[, &quot;prob&quot;], type = &quot;l&quot;) # arcs probability by decreasing order
</code></pre>
<p><img src="2022-11-01-nagara-dynamic_files/figure-html/unnamed-chunk-14-2.png" width="1440" /></p>
<pre><code class="language-r">sum(DBNGeneNet.edges$prob &gt; 0.95) # arcs with prob &gt; 0.95
</code></pre>
<pre><code>## [1] 8
</code></pre>
<p><em>First-order conditional dependency</em> with the <code>G1DBN</code> package:</p>
<pre><code class="language-r">G1DB_BN &lt;- DBNScoreStep1(dataVar2seq, method = &quot;ls&quot;)
</code></pre>
<pre><code>## Treating 49 vertices:
## 10% 20% 30% 40% 50% 60% 70% 80% 90% 100%
</code></pre>
<pre><code class="language-r">G1DB_BN &lt;- DBNScoreStep2(G1DB_BN$S1ls, dataVar2seq, method = &quot;ls&quot;, alpha1 = 0.5)
plot(sort(G1DB_BN, decreasing = TRUE), type = &quot;l&quot;, ylab = &quot;Arcs’ p-values&quot;)
</code></pre>
<p><img src="2022-11-01-nagara-dynamic_files/figure-html/unnamed-chunk-15-1.png" width="1440" /></p>
<h3 id="nagarajan-33">Nagarajan 3.3</h3>
<blockquote>
<p>Consider the dimension reduction approaches used in the previous exercise and the <code>arth800</code> data set from the <code>GeneNet</code> package.</p>
</blockquote>
<pre><code class="language-r">data(arth800)
data(arth800.expr)
</code></pre>
<h4 id="part-a-2">Part A</h4>
<blockquote>
<p>For a comparative analysis of the different approaches, select the top 50 arcs for each approach (function <code>BuildEdges</code> from the <code>G1DBN</code> package can be used to that end).</p>
</blockquote>
<p><em>LASSO</em></p>
<pre><code class="language-r">lasso_tresh &lt;- mean(sort(abs(Lasso_mat), decreasing = TRUE)[50:51]) # Lasso_mat from exercise 3.2
lasso_50 &lt;- BuildEdges(score = -abs(Lasso_mat), threshold = -lasso_tresh)
</code></pre>
<p><em>James-Stein shrinkage</em> with the <code>GeneNet</code> package:</p>
<pre><code class="language-r">DBNGeneNet_50 &lt;- cbind(DBNGeneNet.edges[1:50, &quot;node1&quot;], DBNGeneNet.edges[1:50, &quot;node2&quot;])
</code></pre>
<p><em>First-order conditional dependency</em> with the <code>G1DBN</code> package:</p>
<pre><code class="language-r">G1DBN_tresh &lt;- mean(sort(G1DB_BN)[50:51])
G1DBN.edges &lt;- BuildEdges(score = G1DB_BN, threshold = G1DBN_tresh, prec = 3)
</code></pre>
<h4 id="part-b-2">Part B</h4>
<blockquote>
<p>Plot the four inferred networks with the function plot from package <code>G1DBN</code>.</p>
</blockquote>
<p>Four inferred networks? I assume the exercise so far wanted me to also analyse the data using the LASSO approach with the SIMoNe (<code>simone</code>) package. I will skip over that one and continue with the three I have:</p>
<pre><code class="language-r">par(mfrow = c(1, 3))

## LASSO
LASSO_plot &lt;- graph.edgelist(cbind(lasso_50[, 1], lasso_50[, 2]))
Lasso_layout &lt;- layout.fruchterman.reingold(LASSO_plot)
plot(LASSO_plot,
  layout = Lasso_layout,
  edge.arrow.size = 0.5, vertex.size = 10,
  main = &quot;LASSO&quot;
)

## James-Stein
DBN_plot &lt;- graph.edgelist(DBNGeneNet_50)
# DBN_layout &lt;- layout.fruchterman.reingold(DBN_plot)
plot(DBN_plot,
  layout = Lasso_layout,
  edge.arrow.size = 0.5, vertex.size = 10,
  main = &quot;GeneNet&quot;
)

## First-order conditional
G1DBN_plot &lt;- graph.edgelist(cbind(G1DBN.edges[, 1], G1DBN.edges[, 2]))
# G1DBN_layout = layout.fruchterman.reingold(G1DBN_plot)
plot(G1DBN_plot,
  layout = Lasso_layout,
  edge.arrow.size = 0.5, vertex.size = 10,
  main = &quot;G1DBN&quot;
)
</code></pre>
<p><img src="2022-11-01-nagara-dynamic_files/figure-html/unnamed-chunk-20-1.png" width="1440" /></p>
<h4 id="part-c-2">Part C</h4>
<blockquote>
<p>How many arcs are common to the four inferred networks?</p>
</blockquote>
<pre><code class="language-r">## extract edges
LASSO_el &lt;- as_edgelist(LASSO_plot)
DBN_el &lt;- as_edgelist(DBN_plot)
G1DBN_el &lt;- as_edgelist(G1DBN_plot)

## number of repeated edges in pairwise comparisons
sum(duplicated(rbind(LASSO_el, DBN_el)))
</code></pre>
<pre><code>## [1] 0
</code></pre>
<pre><code class="language-r">sum(duplicated(rbind(LASSO_el, G1DBN_el)))
</code></pre>
<pre><code>## [1] 6
</code></pre>
<pre><code class="language-r">sum(duplicated(rbind(DBN_el, G1DBN_el)))
</code></pre>
<pre><code>## [1] 1
</code></pre>
<pre><code class="language-r">### all at once
sum(duplicated(rbind(LASSO_el, DBN_el, G1DBN_el)))
</code></pre>
<pre><code>## [1] 7
</code></pre>
<h4 id="part-d-2">Part D</h4>
<blockquote>
<p>Are the top 50 arcs of each inferred network similar? What can you conclude?</p>
</blockquote>
<p>No, they are not. I can conclude that different dimension reductions produce different DAG structures.</p>
<h2 id="session-info">Session Info</h2>
<pre><code class="language-r">sessionInfo()
</code></pre>
<pre><code>## R version 4.2.1 (2022-06-23 ucrt)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19044)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Germany.utf8  LC_CTYPE=English_Germany.utf8    LC_MONETARY=English_Germany.utf8 LC_NUMERIC=C                     LC_TIME=English_Germany.utf8    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] G1DBN_3.1.1         igraph_1.3.4        GeneNet_1.2.16      fdrtool_1.2.17      longitudinal_1.1.13 corpcor_1.6.10      lars_1.3            vars_1.5-6          lmtest_0.9-40      
## [10] urca_1.3-3          strucchange_1.5-3   sandwich_3.0-2      zoo_1.8-10          MASS_7.3-58.1      
## 
## loaded via a namespace (and not attached):
##  [1] highr_0.9         bslib_0.4.0       compiler_4.2.1    jquerylib_0.1.4   R.methodsS3_1.8.2 R.utils_2.12.0    tools_4.2.1       digest_0.6.29     jsonlite_1.8.0    evaluate_0.16    
## [11] nlme_3.1-159      R.cache_0.16.0    lattice_0.20-45   pkgconfig_2.0.3   rlang_1.0.5       cli_3.3.0         rstudioapi_0.14   yaml_2.3.5        blogdown_1.13     xfun_0.33        
## [21] fastmap_1.1.0     styler_1.8.0      stringr_1.4.1     knitr_1.40        vctrs_0.4.1       sass_0.4.2        grid_4.2.1        R6_2.5.1          rmarkdown_2.16    bookdown_0.29    
## [31] purrr_0.3.4       magrittr_2.0.3    htmltools_0.5.3   stringi_1.7.8     cachem_1.0.6      R.oo_1.25.0
</code></pre>

          </div>

          

<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/bayes/">Bayes</a>
  
  <a class="badge badge-light" href="/tag/networks/">Networks</a>
  
  <a class="badge badge-light" href="/tag/bayesian-statistics/">Bayesian Statistics</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
</div>



          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/courses/bayes-nets/inference/" rel="next">Bayesian Network Inference</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/courses/bayes-nets/introduction/" rel="prev">Graph Theory &amp; Bayes</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on 2022-11-01</p>

          





          


          


  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/courses/bayes-nets/inference/">Bayesian Network Inference</a></li>
      
      <li><a href="/courses/bayes-nets/static/">Additional Static Exercises</a></li>
      
      <li><a href="/courses/bayes-nets/networksr/">(Bayesian) Networks &amp; R</a></li>
      
      <li><a href="/courses/bayes-nets/introduction/">Graph Theory &amp; Bayes</a></li>
      
      <li><a href="/courses/bayes-nets/part-3/">Hybrid Bayesian Networks</a></li>
      
    </ul>
  </div>
  



        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    © 2024
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
  </p>
</footer>


    </main>
  </div>
</div>


      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/latex.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js" integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.66c553246b0f279a03be6e5597f72b52.js"></script>

    






  
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
